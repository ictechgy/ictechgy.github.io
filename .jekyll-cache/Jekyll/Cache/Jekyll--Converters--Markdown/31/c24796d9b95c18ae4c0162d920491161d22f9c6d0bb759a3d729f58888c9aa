I"å0<p>ì´ ê¸€ì„ ì½ê¸° ì „ <a href="https://eunjin3786.tistory.com/75">eungdingë‹˜ì˜ ë¸”ë¡œê·¸</a>ì™€ <a href="https://jcsoohwancho.github.io/2019-08-09-RxSwift%EA%B8%B0%EC%B4%88-Driver-&amp;-Signal/">Rhynoë‹˜ì˜ ë¸”ë¡œê·¸</a>ê¸€ì„ ì°¸ê³ í•´ë³´ì.</p>

<p>Â </p>

<h1 id="signalê³¼-driver">Signalê³¼ Driver?</h1>
<p>Signalê³¼ DriverëŠ” ë©”ì¸ì“°ë ˆë“œì—ì„œì˜ ë™ì‘ì„ ë³´ì¥í•˜ê³  errorë¥¼ ë°˜í™˜í•˜ì§€ ì•ŠëŠ”ë‹¤. 
ê·¸ëŸ°ë° ë‚˜ëŠ” â€˜errorë¥¼ ë°˜í™˜í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒâ€™ì´ ì—ëŸ¬ê°€ ë‚œ ê²ƒì— ëŒ€í•´ ìŠ¤íŠ¸ë¦¼ ì¢…ë£Œ ë°©ì§€ë¥¼ í•´ì¤€ë‹¤ëŠ” ì˜ë¯¸ë¡œ ì²˜ìŒì— ë°›ì•„ë“¤ì˜€ë‹¤. ê·¸ë˜ì„œ íŠ¹ì • Observable ë’¤ì— asSignalì´ë‚˜ asDriverë¥¼ ì¨ì£¼ë©´ í•´ë‹¹ Observableì—ì„œ errorê°€ ë‚œë‹¤ê³  í•˜ë”ë¼ë„ ì „ì²´ì ì¸ ìŠ¤íŠ¸ë¦¼ì€ ì¢…ë£Œê°€ ë˜ì§€ ì•Šì„ ê²ƒì´ë¼ê³  ìƒê°í–ˆë‹¤.</p>

<p>ê·¸ë˜ì„œ ëª‡ê°€ì§€ í…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•´ë³´ì•˜ë‹¤.</p>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">button</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>

<span class="k">let</span> <span class="nv">publishSubject</span><span class="p">:</span> <span class="kt">PublishSubject</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;</span> <span class="o">=</span> <span class="kt">PublishSubject</span><span class="p">()</span>
        
<span class="n">_</span> <span class="o">=</span> <span class="n">button</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span>
		<span class="o">.</span><span class="nf">subscribe</span><span class="p">(</span><span class="nv">onNext</span><span class="p">:</span> <span class="p">{</span>
				<span class="n">publishSubject</span><span class="o">.</span><span class="nf">onError</span><span class="p">(</span><span class="kt">TestError</span><span class="o">.</span><span class="n">fakeError</span><span class="p">)</span>
		<span class="p">})</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">publishSubject</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"PublishSubject"</span><span class="p">)</span>
		<span class="o">.</span><span class="nf">asSignal</span><span class="p">(</span><span class="nv">onErrorJustReturn</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Signal"</span><span class="p">)</span>
		<span class="o">.</span><span class="nf">emit</span><span class="p">()</span>
        <span class="c1">//ê³¼ì—° ìŠ¤íŠ¸ë¦¼ì€ ëŠê¸°ì§€ ì•Šê³  ê³„ì† ìœ ì§€ë ê¹Œ?</span>
				
<span class="kd">enum</span> <span class="kt">TestError</span><span class="p">:</span> <span class="kt">Error</span> <span class="p">{</span>
		<span class="k">case</span> <span class="n">fakeError</span>
<span class="p">}</span>
</code></pre></div></div>
<p>ë²„íŠ¼ì„ íƒ­í•˜ëŠ” ê²½ìš° publishSubjectë¡œ errorê°€ ë„˜ì–´ê°€ë„ë¡ í–ˆê³  ì´ë¥¼ ë¯¸ë¦¬ subscribe(emit)í•´ì¤€ ìŠ¤íŠ¸ë¦¼ì—ì„œ ë°›ë„ë¡ ì„¸íŒ…í•´ë‘ì—ˆë‹¤.
ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Signal -&gt; subscribed
PublishSubject -&gt; subscribed
//ë²„íŠ¼ì„ íƒ­í–ˆê³  publishSubjectë¡œ errorê°€ ë„˜ì–´ê°
PublishSubject -&gt; Event error(fakeError)
Signal -&gt; Event next(0)
Signal -&gt; Event completed
Signal -&gt; isDisposed
PublishSubject -&gt; isDisposed
</code></pre></div></div>
<p><strong>ì‹œí€€ìŠ¤ê°€ ëª¨ë‘ disposedëê³  ìŠ¤íŠ¸ë¦¼ì´ ì¢…ë£Œë˜ì—ˆë‹¤.</strong>
Signalì´ë“  Driverì´ë“  Observableì— errorê°€ ìˆëŠ” ê²½ìš° ì‹œí€€ìŠ¤ì˜ ì¢…ë£Œë¥¼ ë§‰ì•„ì£¼ëŠ” ê²ƒì€ ì•„ë‹ˆì—ˆë‹¤. ë‹¤ë§Œ ì—ëŸ¬ê°€ ë‚œ ê²½ìš° ì´ë¥¼ ì´í›„ì— ì–´ë–»ê²Œ ì²˜ë¦¬í•  ê²ƒì¸ì§€ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆì„ ë¿.</p>

<p>Â </p>

<h2 id="flatmapì—-ì ìš©í•´ë³´ê¸°">flatMapì— ì ìš©í•´ë³´ê¸°</h2>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">secondButton</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">secondButton</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"TAP"</span><span class="p">)</span>
		<span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span>
				<span class="k">return</span> <span class="kt">Observable</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;.</span><span class="nf">error</span><span class="p">(</span><span class="kt">TestError</span><span class="o">.</span><span class="n">fakeError</span><span class="p">)</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"ë‚´ë¶€ Observable"</span><span class="p">)</span>
		<span class="p">}</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"flatMap ì´í›„"</span><span class="p">)</span>
		<span class="o">.</span><span class="nf">asSignal</span><span class="p">(</span><span class="nv">onErrorJustReturn</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Signal ì´í›„"</span><span class="p">)</span>
		<span class="o">.</span><span class="nf">emit</span><span class="p">()</span>
</code></pre></div></div>
<p>ë²„íŠ¼ì„ íƒ­í•˜ëŠ” ê²½ìš° flatMapì—ì„œ errorê°€ ë“¤ì–´ê°€ìˆëŠ” Observableì´ ë°˜í™˜ë˜ë„ë¡ ì„¤ì •í•˜ì˜€ë‹¤.</p>

<p>ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Signal ì´í›„ -&gt; subscribed
flatMap ì´í›„ -&gt; subscribed
TAP -&gt; subscribed
//ë²„íŠ¼ íƒ­
TAP -&gt; Event next(())
ë‚´ë¶€ Observable -&gt; subscribed
ë‚´ë¶€ Observable -&gt; Event error(fakeError)
flatMap ì´í›„ -&gt; Event error(fakeError)
Signal ì´í›„ -&gt; Event next(0)
Signal ì´í›„ -&gt; Event completed
Signal ì´í›„ -&gt; isDisposed
flatMap ì´í›„ -&gt; isDisposed
TAP -&gt; isDisposed
ë‚´ë¶€ Observable -&gt; isDisposed
</code></pre></div></div>
<p>ì—­ì‹œ ë§ˆì°¬ê°€ì§€ë¡œ ì „ì²´ ìŠ¤íŠ¸ë¦¼ì€ ëª¨ë‘ ì¢…ë£Œë˜ì—ˆìœ¼ë©° Signalì€ ì—ëŸ¬ì— ëŒ€í•œ í›„ì†ì²˜ë¦¬ë§Œ ë‹´ë‹¹í•´ ì¤€ ê²ƒì„ ë³¼ ìˆ˜ ìˆì—ˆë‹¤.</p>

<p>Â </p>

<h2 id="ì¶”ê°€-í…ŒìŠ¤íŠ¸-1">ì¶”ê°€ í…ŒìŠ¤íŠ¸ 1</h2>
<p>asSignalì„ ìœ„ë¡œ ì˜¬ë¦¬ë©´ ì–´ë–»ê²Œ ë ê¹Œ?</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">thirdButton</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">thirdButton</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"TAP"</span><span class="p">)</span>
		<span class="o">.</span><span class="nf">asSignal</span><span class="p">(</span><span class="nv">onErrorJustReturn</span><span class="p">:</span> <span class="p">())</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Signal"</span><span class="p">)</span>
		<span class="o">.</span><span class="nf">asObservable</span><span class="p">()</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"flatMap ì´ì „"</span><span class="p">)</span>
		<span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span>
				<span class="k">return</span> <span class="kt">Observable</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;.</span><span class="nf">error</span><span class="p">(</span><span class="kt">TestError</span><span class="o">.</span><span class="n">fakeError</span><span class="p">)</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"ë‚´ë¶€ Observable"</span><span class="p">)</span>
		<span class="p">}</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"flatMap ì´í›„"</span><span class="p">)</span>
		<span class="o">.</span><span class="nf">subscribe</span><span class="p">()</span>
</code></pre></div></div>

<p>ê²°ê³¼ëŠ” ì•„ë˜ì™€ ê°™ë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>flatMap ì´í›„ -&gt; subscribed
flatMap ì´ì „ -&gt; subscribed
Signal -&gt; subscribed
TAP -&gt; subscribed
//ë²„íŠ¼ íƒ­
TAP -&gt; Event next(())
Signal -&gt; Event next(())
flatMap ì´ì „ -&gt; Event next(())
ë‚´ë¶€ Observable -&gt; subscribed
ë‚´ë¶€ Observable -&gt; Event error(fakeError)
flatMap ì´í›„ -&gt; Event error(fakeError)
Unhandled error happened: fakeError
flatMap ì´í›„ -&gt; isDisposed
flatMap ì´ì „ -&gt; isDisposed
Signal -&gt; isDisposed
TAP -&gt; isDisposed
ë‚´ë¶€ Observable -&gt; isDisposed
</code></pre></div></div>
<p>ëª¨ë“  ì‹œí€€ìŠ¤ëŠ” disposedë˜ì—ˆê³  ì „ì²´ ìŠ¤íŠ¸ë¦¼ì´ ì¢…ë£Œë˜ì—ˆë‹¤.</p>

<p>Â </p>

<h2 id="ì¶”ê°€-í…ŒìŠ¤íŠ¸-2">ì¶”ê°€ í…ŒìŠ¤íŠ¸ 2</h2>

<p>ì´ë²ˆì—ëŠ” throwë¥¼ ì¨ë³´ì•˜ë‹¤.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">fourthButton</span><span class="p">:</span> <span class="kt">UIButton</span><span class="o">!</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">fourthButton</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"TAP"</span><span class="p">)</span>
		<span class="o">.</span><span class="n">map</span> <span class="p">{</span>
				<span class="k">throw</span> <span class="kt">TestError</span><span class="o">.</span><span class="n">fakeError</span>
<span class="c1">//returnìœ¼ë¡œ ë°˜í™˜ ì‹œ .asSignal(onErrorJustReturn: 0)ì—ì„œ onErrorJustReturnìœ¼ë¡œ ëŒë ¤ì¤„ 0ê³¼ íƒ€ì…ì´ ê°™ì§€ ì•Šë‹¤ê³  ì˜¤ë¥˜ê°€ ëœ¸</span>
		<span class="p">}</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"map ì´í›„"</span><span class="p">)</span>
		<span class="o">.</span><span class="nf">asSignal</span><span class="p">(</span><span class="nv">onErrorJustReturn</span><span class="p">:</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"Signal ì´í›„"</span><span class="p">)</span>
		<span class="o">.</span><span class="nf">emit</span><span class="p">()</span>
</code></pre></div></div>
<p>map operator ë‚´  <span style="color:black"><code class="language-plaintext highlighter-rouge">throw TestError.fakeError</code></span> ë¼ê³  ì“´ ë¶€ë¶„ì„ <span style="color:black"><code class="language-plaintext highlighter-rouge">return TestError.fakeError</code></span>ë¼ê³  ì“°ëŠ” ê²½ìš° ë°‘ì˜ <span style="color:black"><code class="language-plaintext highlighter-rouge">.asSignal(onErrorJustReturn: 0)</code></span>ë¶€ë¶„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. 
ì˜¤ë¥˜ ë©”ì‹œì§€: <code class="language-plaintext highlighter-rouge">Cannot convert value of type 'Int' to expected argument type 'ViewController.TestError'</code>
mapì„ í†µí•´ ë°˜í™˜ë˜ëŠ” ë°ì´í„° íƒ€ì…ì¸ TestErrorì™€ asSignalì—ì„œ ì˜¤ë¥˜ì— ëŒ€í•´ ë¦¬í„´í•´ì£¼ëŠ” 0ì´ë¼ëŠ” ê°’ ë°ì´í„° íƒ€ì…ì´ ì„œë¡œ ë§ì§€ ì•Šë‹¤ëŠ” ê²ƒ.
ê·¸ë˜ì„œ return TestError.fakeErrorì— ë§ì¶° .asSignal(onErrorJustReturn: TestError.fakeError)ë¼ê³  ì¨ì¤¬ë”ë‹ˆ ì—ëŸ¬ëŠ” ì‚¬ë¼ì¡Œë‹¤. í•˜ì§€ë§Œ ì˜¤ë¥˜ì— ëŒ€í•´ì„œ ë˜ ì˜¤ë¥˜ë¥¼ ë‚´ë³´ë‚´ëŠ” ê²ƒì€ ì˜ëª»ëœ ê²ƒì´ë¯€ë¡œ.. 
returnìœ¼ë¡œ ì˜¤ë¥˜ë¥¼ ë°˜í™˜ ì‹œ ì˜¤ë¥˜ë¡œ ì¸ì‹í•˜ì§€ ëª»í•˜ëŠ” ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>
:ET