I"ı<h1 id="flatmapì—ì„œ-errorê°€-ë‹´ê¸´-observableì´-ë°˜í™˜ë˜ëŠ”-ê²½ìš°">flatMapì—ì„œ errorê°€ ë‹´ê¸´ Observableì´ ë°˜í™˜ë˜ëŠ” ê²½ìš°</h1>

<p>ì—¬íƒœê¹Œì§€ ë‚˜ëŠ” â€˜<strong>flatMap</strong>ì„ í†µí•´ ë°˜í™˜ë˜ëŠ” Observableì´ ê¸°ì¡´ ì‹œí€€ìŠ¤ì—ëŠ” ì „í˜€ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•ŠëŠ”ë‹¤.â€™ë¼ê³  ìƒê°í•´ì™”ë‹¤. (ì™œê·¸ë¬ëŠ”ì§€ëŠ” ëª¨ë¥´ê² ë‹¤. ì•„ë§ˆë„ ì²˜ìŒì— ì–´ë µë‹¤ê³  ëŠê»´ì„œ ë‚˜ í˜¼ìì„œ ì´ë ‡ê²Œ ì •ì˜ë‚´ë ¸ë˜ ê²ƒ ê°™ë‹¤.)</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">_</span> <span class="o">=</span> <span class="n">button</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"TAP"</span><span class="p">)</span>
            <span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kt">Observable</span><span class="o">&lt;</span><span class="kt">Int</span><span class="o">&gt;.</span><span class="nf">error</span><span class="p">(</span><span class="kt">TestError</span><span class="o">.</span><span class="n">fakeError</span><span class="p">)</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"ë‚´ë¶€ Observable"</span><span class="p">)</span>
            <span class="p">}</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"flatMap ì´í›„"</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">subscribe</span><span class="p">()</span>
<span class="c1">//ì—¬ê¸°ì„œëŠ” ìŠ¤ìŠ¤ë¡œ disposeë˜ëŠ”ì§€ í™•ì¸ë§Œ í•˜ë©´ ë˜ë¯€ë¡œ êµ³ì´ disposeBagì—ëŠ” ë„£ì§€ ì•Šì•˜ë‹¤. </span>

<span class="kd">enum</span> <span class="kt">TestError</span><span class="p">:</span> <span class="kt">Error</span> <span class="p">{</span>
        <span class="k">case</span> <span class="n">fakeError</span>
    <span class="p">}</span>
</code></pre></div></div>
<p>ìœ„ ì½”ë“œë¥¼ ì˜ˆì‹œë¡œ ë“¤ì–´ë³´ê² ë‹¤.  <br />
ì´ì „ì˜ ë‚˜: â€œflatMapì—ì„œ errorë¥¼ í™•ì •ì ìœ¼ë¡œ ê°€ì§€ëŠ” Observableì„ ë°˜í™˜í•œë‹¤ê³  í•´ë„.. ì–´ì°¨í”¼ buttonì— ëŒ€í•œ Observableê³¼ëŠ” ë‹¤ë¥¸ ë³„ë„ì˜ ì‹œí€€ìŠ¤ì´ë‹ˆ ì„œë¡œ ì˜í–¥ì€ ì—†ê² ë„¤. ë²„íŠ¼ íƒ­í• ë•Œë§ˆë‹¤ ì—ëŸ¬ ë©”ì‹œì§€ê°€ ë‚˜ì˜¤ë ¤ë‚˜?â€
ë‚´ê°€ ì˜ˆìƒí–ˆë˜ ìŠ¤íŠ¸ë¦¼ ì „ê°œëŠ” ì•„ë˜ì™€ ê°™ì•˜ë‹¤.</p>
<pre>
TAP             --T--------T--------T-----....----&gt;     
ë‚´ë¶€ Observable  --X-&gt;    --X-&gt;    --X-&gt; 
flatMap ì´í›„     --X-&gt;    --X-&gt;    --X-&gt;
</pre>
<p>flatMap ì´í›„ì— ëŒ€í•œ ìŠ¤íŠ¸ë¦¼ì´ ëŠê¸´ë‹¤ê³ ëŠ” í•˜ë”ë¼ë„ TAP ë¶€ë¶„ì— ìˆëŠ” ê¸°ì¡´ ì‹œí€€ìŠ¤ëŠ” ì•ˆëŠê¸°ê³  ê³„ì† ì‚´ì•„ìˆì„ ê²ƒìœ¼ë¡œ ìƒê°í–ˆë‹¤.</p>

<p><em>ê·¸ëŸ°ë° ìœ„ì˜ ë‚´ ìƒê°ì€ ì˜ëª»ëœ ê²ƒì´ì—ˆë‹¤.</em>   <br />
<strong>flatMapì—ì„œ ë°˜í™˜ë˜ëŠ” Observableì´ errorë¥¼ ì§€ë‹ˆê³  ìˆë‹¤ë©´ ì´ëŠ” ê¸°ì¡´ì˜ ì‹œí€€ìŠ¤ì—ë„ ì˜í–¥ì„ ë¯¸ì¹œë‹¤.</strong></p>
<pre>
TAP             --T-|&gt;      
ë‚´ë¶€ Observable  --X-&gt;
flatMap ì´í›„     --X-&gt;
</pre>
<p>ìœ„ì™€ê°™ì´ ë§ì´ë‹¤.</p>

<p>ìœ„ì˜ í…ŒìŠ¤íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•œ ë¡œê·¸ ì¶œë ¥ì€ ì•„ë˜ì™€ ê°™ì•˜ë‹¤.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>flatMap ì´í›„ -&gt; subscribed
TAP -&gt; subscribed
//íƒ­ ë²„íŠ¼ì„ ëˆ„ë¦„
TAP -&gt; Event next(())
ë‚´ë¶€ Observable -&gt; subscribed
ë‚´ë¶€ Observable -&gt; Event error(fakeError)
flatMap ì´í›„ -&gt; Event error(fakeError)
Unhandled error happened: fakeError  //errorê°€ ê¸°ì¡´ ì‹œí€€ìŠ¤ì—ë„ ì˜í–¥ì„ ë¯¸ì¹œë‹¤. 
flatMap ì´í›„ -&gt; isDisposed
TAP -&gt; isDisposed
ë‚´ë¶€ Observable -&gt; isDisposed
</code></pre></div></div>

<p>ì°¸ê³ í•œ ì‚¬ì´íŠ¸: <a href="https://github.com/ReactiveX/RxSwift/issues/1162">RxSwift Github Issue</a></p>

<p>Â </p>

<h1 id="flatmap-ë‚´ì—ì„œ-ë°˜í™˜ë˜ëŠ”-observableì´-subscribe-ë˜ëŠ”-ì‹œì ">flatMap ë‚´ì—ì„œ ë°˜í™˜ë˜ëŠ” Observableì´ subscribe ë˜ëŠ” ì‹œì </h1>
<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">_</span> <span class="o">=</span> <span class="n">button</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="n">tap</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"TAP"</span><span class="p">)</span>
            <span class="o">.</span><span class="n">flatMap</span> <span class="p">{</span>
                <span class="k">return</span> <span class="kt">BehaviorRelay</span><span class="p">(</span><span class="nv">value</span><span class="p">:</span> <span class="kt">Int</span><span class="o">.</span><span class="nf">random</span><span class="p">(</span><span class="nv">in</span><span class="p">:</span> <span class="mi">0</span><span class="o">...</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"ë‚´ë¶€ Observable"</span><span class="p">)</span><span class="o">.</span><span class="nf">take</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="p">}</span><span class="o">.</span><span class="nf">debug</span><span class="p">(</span><span class="s">"flatMap ì´í›„"</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">subscribe</span><span class="p">()</span>
</code></pre></div></div>

<p>ê²°ê³¼ ì¶œë ¥</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>flatMap ì´í›„ -&gt; subscribed
TAP -&gt; subscribed
//ë²„íŠ¼ì„ ëˆ„ë¦„
TAP -&gt; Event next(())
ë‚´ë¶€ Observable -&gt; subscribed
ë‚´ë¶€ Observable -&gt; Event next(34)
flatMap ì´í›„ -&gt; Event next(34)
ë‚´ë¶€ Observable -&gt; isDisposed

</code></pre></div></div>
<p>flatMapì—ì„œ ë°˜í™˜ë˜ëŠ” Observableì€ ì²˜ìŒë¶€í„° subscribeë˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤. 
ë³¸ê²©ì ìœ¼ë¡œ ìŠ¤íŠ¸ë¦¼ì´ ì‹œì‘ë˜ê³  <strong>flatMapì´ ì‘ë™í•˜ëŠ” ì‹œì ì— subscribeëœë‹¤.</strong></p>

<p><strong>ë” ì¤‘ìš”í•˜ê²Œ ì‚´í´ë´ì•¼ í•  ê²ƒì€ error ë•Œ ì™€ëŠ” ë‹¤ë¥´ê²Œ ì •ìƒ ì‘ë™ì´ ëœ ê²½ìš° ê¸°ì¡´(ì „ì²´) ì‹œí€€ìŠ¤ê°€ ì¢…ë£Œë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì ì´ë‹¤.</strong></p>

<p>ë‚´ë¶€ Observableì— BehaviorRelayë¥¼ ë„£ê³  take(1)ì„ í•´ì¤¬ëŠ”ë°, ì‚¬ì‹¤ Observable.just()ë¥¼ ì‚¬ìš©í•´ë„ ëœë‹¤. ë‹¤ë§Œ takeë¥¼ ì“°ëŠ” ì´ìœ ë¥¼ ê°™ì´ ì²´í¬í•´ë³´ê³ ì ì‚¬ìš©í•´ë³´ì•˜ë‹¤.
<a href="https://ictechgy.github.io/rxswift/take/">take Operatorì— ëŒ€í•œ ê¸€(RxSwift)</a></p>
:ET