<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Linux2_day14 - 개발 끄적끄적</title>
<meta name="description" content="DNS(Domain Name System) ">


  <meta name="author" content="JJanghong">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="개발 끄적끄적">
<meta property="og:title" content="Linux2_day14">
<meta property="og:url" content="http://localhost:4000/linux/Linux2_day14/">


  <meta property="og:description" content="DNS(Domain Name System) ">



  <meta property="og:image" content="http://localhost:4000/assets/images/photo-hangang.jpeg">





  <meta property="article:published_time" content="2020-05-26T00:00:00+09:00">





  

  


<link rel="canonical" href="http://localhost:4000/linux/Linux2_day14/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "dev blog",
      "url": "http://localhost:4000/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="개발 끄적끄적 Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          개발 끄적끄적
          <span class="site-subtitle">개발공부</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="">About</a>
            </li><li class="masthead__menu-item">
              <a href="/about/"></a>
            </li><li class="masthead__menu-item">
              <a href="">연도별</a>
            </li><li class="masthead__menu-item">
              <a href="/posts/"></a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/photo-avatar.jpeg" alt="JJanghong" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">JJanghong</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>공부중입니다.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Republic of Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:ictechgy@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/ictechgy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Linux2_day14">
    <meta itemprop="description" content="DNS(Domain Name System)">
    <meta itemprop="datePublished" content="2020-05-26T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Linux2_day14
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  13 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>DNS(Domain Name System)</p>

<p>도메인 네임 공간</p>
<ul>
  <li>인터넷 공간에서 사용되는 도메인의 계층적 구조 공간을 의미(Tree구조)</li>
  <li>디렉토리나 폴더의 계층적 구조처럼 도메인도 계층적 구조로 관리</li>
  <li>구조는 점(dot)으로 구분되고 최상위로부터 순차적으로 나타냄</li>
  <li>하위 호스트 레이블부터 시작하여 루트 호스트까지 경로에 위치한 모든 호스트들의 레이블에 점을 붙여서 연결</li>
  <li>각 레이블이 점으로 연결되어 도메인 네임을 설정</li>
</ul>

<p>예를 들어,
www.kgitbank.co.kr 에서 각각의 www, kgitbank, co, kr들은 점으로 구분하면서 붙여서 연결
www가 맨 하위 호스트 레이블이며, 오른쪽으로 갈수록 상위로 올라가는 레이블이다. 맨 마지막에는 원래 점(.)이 있는데 보통은 생략하며 이는 루트호스트를 의미한다.</p>

<p>IP는 뒤로 갈수록 범위가 좁아지는 반면(오른쪽으로 읽을 수록 해당 IP를 쓰는 사람을 특정할 수 있음) FQDN은 뒤로갈수록 범위가 넓어지는 방식(즉, 맨 오른쪽에서 왼쪽으로 읽어가야 해당 웹페이지를 특정할 수 있음)</p>

<p>도메인 네임 구조</p>
<ul>
  <li>루트 도메인(.)은 최상위 DNS로서 인터넷 주소창에서는 생략할 수 있고 모든 도메인을 기록(가장 꼭대기)</li>
  <li>전 세계적으로 오직 13대의 대형서버로 구축되어 있으며 미국 10대, 네덜란드 1대, 노르웨이 1대, 일본 1대 각각 1대씩의 대형서버로 구축되어 있음</li>
  <li>우리나라의 경우 옛날에는 일본의 M-ROOT DNS 를 사용해 왔음</li>
  <li>그러다가 ROOT DNS 미러 서버의 국내 운영이 공식적으로 개통되었음
미러(Mirror)서버란 글로벌 오리지널 루트 서버를 복사한 것으로서 거의 같은 기능을 가지고 있음.
전 세계적으로 67대의 미러 서버가 있고 미국이 24대, 한국과 영국, 네덜란드, 중국이 3대씩 보유하고 있음
우리나라는 KRNIC(한국인터넷진흥원), KT(한국통신), KNIX(한국인터넷연동센터)에서 각각 한대씩 운영중임
→ 미러서버가 생긴 이유는 13개의 ROOT서버에 DDoS(분산 서비스 거부 공격)이 있었어서 ROOT DNS 13대 중 무려 9대의 대형서버가 영향을 받게 됨. 따라서 미러서버를 만들어 운영하게 됨
⇒ kt가 있는 이유는 예전에 우리나라 통신사는 kt밖에 없었기 때문에 그 때 미러서버로서 운영을 해서가 아닐까 생각이 든다.
학원에서는 대표적으로 KT를 쓰는데 cmd창에 ipconfig /all을 써보면 DNS서버가 168.126.63.1 로 잡혀있다. 저 IP는 KT의 DNS서버이다.
집에서는 111.118.0.1 인데 이건 어떤 DNS서버를 가리키고 있는건지 모르겠다.</li>
</ul>

<p>FQDN의 구성체계 - 계층적구조로서 루트도메인으로부터 뻗어나간다.</p>

<p>아래의 모식도는 www.google.com 과 www.centos.org 그리고 www.kgitbank.co.kr 이라는 세 도메인을 통하여 그 계층적 형태를 구조화 한 것이다.</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82836302-3e772200-9f01-11ea-84bf-7bf7bb113de2.png" alt="image" /></p>

<p>Top Level Domain(TLD)</p>
<ul>
  <li>최상위 도메인은 웹 구성에서 최고 수준</li>
</ul>

<p>일반적으로 최상위 도메인에는 다음과 같이 두가지 종류가 있음</p>

<p>1) gTLD(Generic Top Level Domain) - 일반적인 탑레벨 도메인
예를 들어, .com(미국영리기관), .org(미국비영리기관),  .net(미국네트워크기관), .gov(미국정부기관), .edu(미국교육기관), .mil(미국군사기관) 등</p>

<p>.com에서는 도메인을 돈을 받고 제공하며 org는 돈을 안받는 대신 광고등으로 재원을 충당
→ 이 아니라, .com 이면 이는 영리기관을 의미하며 .org면 비영리기관임을 도메인네임을 통해 알 수 있는 것 아닐까?</p>

<p>2) ccTLD(Country Code Top Level Domain) - 국가를 나타내는 탑레벨 도메인
예를 들어, .kr(대한민국), .kp(북한), .jp(일본), .cn(중국), .us(미국) 등</p>

<p>Second Level Domain(SLD) → google, centos, co</p>
<ul>
  <li>차상위 도메인</li>
  <li>이 부분은 Top Level Domain 의 바로 좌측에 표시되는 도메인 네임중 고유한 부분</li>
  <li>자신이나 자신의 제공 내역을 다른 사이트들과 차별화하기 위해 차상위 도메인을 등록
(co는 기관을 의미한다. company? corporation?)
→ 이를테면 네이버 www.naver.com 에서 naver라는 것과, www.daum.net 에서 daum이라는 것이 차상위 도메인에 해당한다. 즉 각각 naver와 daum은 자신들이 제공하는 서비스를 다른 사이트들과 구분하기 위해 저 차상위 도메인을 등록하였다.</li>
</ul>

<p>3단계 도메인 → www, ftp, kgitbank 등</p>
<ul>
  <li>서브 도메인이라고도 하며 차상위 도메인 네임 앞에 표시되는 도메인 네임의 한 부분</li>
</ul>

<p>4단계 도메인(3단계 이후부터는 서브 도메인이라고 부름)</p>

<p>FQDN 도메인에서는 모든 도메인을 다 알고 있는 루트도메인으로부터 왼쪽으로 갈수록 아래로 내려가는 계층적 구조형태이다.
www.naver.com 은 3단계로 이루어져있으며
www.kgitbank.co.kr 은 4단계로서 서브도메인 www까지 존재한다.</p>

<p>세로로 늘여서 보면
.
kr
co
kgitbank
www
이렇게 되어있는데, 아래로 갈수록 하위임.(계층적구조)</p>

<p>DNS가 하는 일</p>
<ul>
  <li>웹 사이트, E-mail, 온라인 뱅킹 등등에서 많이 사용한다.</li>
  <li>자신이 어떤 사이트를 운영하는 경우 이 DNS시스템에 자신의 IP와 서버를 등록시켜서 내 도메인으로 접속하려는 경우 내가 등록한 IP로 접속할 수 있게끔 만듦</li>
</ul>

<p>취약점</p>
<ul>
  <li>E-mail 가로채기, 웹 사이트 사칭, 암호 및 로그인 정보 훔치기 등
→ DNS서버를 해킹해서 특정 도메인에 대한 IP를 이상한 곳으로 접속시킬수도 있지만 이것보다는.. 각각의 클라이언트 자체를 해킹해서 DNS서버로부터 받은 IP값을 변조시킨 뒤 특정 도메인에 대해 이상한 IP로 접속시키도록 만드는 방법 등이 있다.(피싱)</li>
</ul>

<p>IANA(Internet Assigned Numbers Authority)</p>
<ul>
  <li>인터넷 할당 번호 관리기관의 약자로 최상위 도메인 등을 관리하는 단체이다.</li>
  <li>다양한 활동을 하는데, .int, .arpa 도메인과 같은 특수한 도메인도 관리하며 IDN Partieces resource 등의 DNS 루트를 관리하는 도메인 이름 등 세계적인 IP pool과 AS 번호 등을 조정하며 직역 인터넷 레지스트리에 그것을 제공하는 번호 자원 , 인터넷 프로토콜의 번호를 매기는 프로토콜 할당 등 그룹화 하는 일들을 하는 기관
→ ICANN이 설립 되기 전까지 이 업무를 수행함</li>
</ul>

<p>ICANN(Internet Corporation for Assigned Names and Numbers)</p>
<ul>
  <li>우리말로 ‘국제 도메인 관리 기구’혹은 국제 인터넷 주소 관리 기구’</li>
  <li>비영리기관으로 인터넷 도메인 관리와 정책을 결정하는 도메인 관련 국제최고기구</li>
</ul>

<p>⇒ 구글에 IANA 및 ICANN 검색</p>

<p>DNS 작동 원리(구글에 dns 작동원리 라고 치면 많이 나온다)</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82836342-4a62e400-9f01-11ea-9066-7781928fd44e.png" alt="image" /></p>

<p>예를 들어, www.example.com 사이트에 대한 정보를 요청(주소창에 치거나..cmd창에 ping명령어를 친다거나 ftp등을 접속하려 한다거나 등등)</p>

<p>1)	1) 내 PC → 해당 도메인에 대한 것을local 네임서버에 질의
⇒  로컬네임서버란 ipconfig /all 를 치면 나오는 DNS IP에 대응하는 서버(학원에서는 로컬네임서버가 KT)</p>

<p>local 네임서버가 www.example.com 에 대한 정보를 가지고 있다면 바로 조회는 끝나게 됨(위 그림에서 바로 8번으로 넘어감)
그러나 없다면 root 네임서버에게 다시 질의(Query)</p>

<p>2)	local 네임서버 → root 네임서버(도메인 맨 오른쪽의 생략된 온점)</p>

<p>3)	root 네임 서버는 www.example.com에 대한 전체 정보는 없으나 대신 .com 도메인을 관리하고 있는 서버 정보를 알려줌</p>

<p>4)	local 네임 서버는 .com 을 관리하는 네임서버에 www.example.com에 대한 정보를 요청</p>

<p>5)	.com 네임서버는 example 도메인을 관리하고 있는 네임 서버 정보를 알려줌</p>

<p>6)	local 네임 서버는 example.com 네임서버에 www.example.com에 대한 정보를 요청</p>

<p>7)	.example 네임서버는 local 네임서버에게 www.example.com 에 대한 IP정보를 알려줌
즉 example 네임서버는 www.example.com 에서 www에 해당하는 부분에 대한 정보를 알고 있음</p>

<p>8)	local 네임서버는 www.example.com의 IP정보를 사용자 PC에 알려줌</p>

<p>네임서버의 유형</p>

<p>첫번째, Primary(주) Name Server(Master DNS)</p>
<ul>
  <li>1차 네임서버(혹은 주 네임서버)라 하며 zone(영역)의 모든 데이터들과 zone(영역)의 모든 권한을 가지고 있는 중요한 서버
즉! 도메인 네임서버 사용시에 반드시 구축을 해야함</li>
</ul>

<p>두번째, Secondary(보조) Name Server(Slave DNS)</p>
<ul>
  <li>2차 네임서버(혹은 보조 네임서버)라 하며 1차 네임서버가 다운되었을 때 그 정보를 대신해서 사용하는 용도
즉! 1차 네임서버의 백업을 담당하며 반드시 구축 해야하는 것은 아니다.</li>
</ul>

<p>(slave - 노예.. 2차 네임서버를 노예라고 하는건가)</p>

<p>내 리눅스 서버를 DNS서버로 구축할 때의 설정파일에 대하여</p>

<p>1)	/etc/host.conf</p>
<ul>
  <li>어떤 도메인에 대한 IP를 찾을 때 우선순위를 지정하는 파일</li>
</ul>

<p>내가 어떤 사람에게 전화하고자 할 때 내가 가지고 있는 전화번호부를 먼저 볼 것인지 인터넷검색을 먼저 할 것인지 그런 우선순위를 설정하는 파일이다.</p>

<p>즉, 특정 도메인을 찾아 갈 때 /etc/hosts 라는 내 파일을 보고 그 답을 찾을 것인지, 아니면 외부로부터 그 답을 찾을 것인지 그 우선순위를 설정 가능하다.</p>

<p>구글검색해보니, 외부에서 어떤 도메인에 대한 IP주소를 요청한 경우 어떤 것을 먼저 찾아볼 지를 결정하는 파일이라고 한다.(내 리눅스를 DNS서버로 구축한 경우)</p>

<p>cat /etc/host.conf 해보면 현재는 multi on만 존재하는데 order host 또는 order bind 값을 작성할 수 있다.</p>

<p>항목
order host(또는 bind)
→ order항목의 의미는 도메인에 질의 할 때 host는 /etc/hosts(파일)을 먼저 참고하고 bind는 외부 또다른 DNS를 참고하겠다는 의미이다.</p>

<p>multi on(또는 off)
→ /etc/hosts(파일)에 하나의 호스트에 대한 여러개의  IP주소를 설정 가능하게 하는 항목
⇒ 여러개 설정 해두면 특정 도메인에 대해 첫번째 IP로 접속 안되면 그 다음 것 보고 뭐 그러나?</p>

<p>참고 - order bind라고 되어있으면 일단 /etc/resolv.conf를 찾아가게 된다.</p>

<p>2)	/etc/hosts</p>
<ul>
  <li>호스트 네임과 IP주소의 관계를 설정하는 파일</li>
</ul>

<p>좋은점</p>
<ul>
  <li>설정이 매우 간단함
설정방법
IP주소    FQDN    Alias(별칭)</li>
</ul>

<p>한계점</p>
<ul>
  <li>지속적인 관리가 필요</li>
  <li>로컬시스템에서만 유효(외부에서는 이 설정값을 못쓴다는 거겠지)</li>
  <li>보안상 취약(이 설정파일을 건드리기만 하면 특정 도메인에 대한 IP값을 쉽게 변조시킬 수 있음)</li>
</ul>

<p>참고로 Windows 운영체제에도 있음. 경로는 C:\Windows\System32\drivers\etc\hosts</p>

<p>cat /etc/hosts 로 파일 내부를 보면 현재 localhost에 대해 루프백IP로 설정되어있다.
또한 IPv6의 루프백 IP도 적혀있다. → 윈도우에 있는 hosts파일도 동일하다.
즉 내가 주소창에 localhost라고 검색했을 때 이 /etc/hosts파일을 참고하는 경우 내 IP로 접속을 하게 된다.</p>

<p>옛날에는 이 파일에 도메인에 대한 IP주소가 다 기록되어있었는데, 이제는 bind를 통해 다른 외부 DNS서버를 이용한다.
예전에는 다 내가 일일히 업데이트를 해야하고 작성하고 수정해야했지만 이제는 외부 DNS서버에서 관리를 하므로 편리하다. (로컬에서 관리하면 해킹에도 취약)
지금은 /etc/hosts 이 파일을 쓰지 않는다. 지금은 bind를 씀
/etc/host.conf가 /etc/hosts를 쓰도록(order host) 되어있으면 안쓰게 하면 됨
이곳에 어떤 도메인에 대한 대응IP를 적어놓으면.. 이제 그 도메인을 입력했을 시 절대로 외부에 묻지 않고 이제 정해진 IP로만 접속하게 됨</p>

<p>만약 내가 KT DNS서버라고 치자. /etc/host.conf에는 order host,bind 라고 되어있을 것이다. 즉, 일단 누군가가 질의를 하면 내가 가지고 있는 데이터베이스에서 조회를 한 뒤 그 결과값을 넘겨주고 만약 없다면 bind응용소프트웨어를 통해 루트도메인에게 질의를 하게 된다.</p>

<p>3)	/etc/resolv.conf
/etc/host.conf 에 order bind 했을 시 도메인에 대한 IP를 찾으러 바깥에 가기 전 일단 이곳에 들림.</p>
<ul>
  <li>호스트가 사용할 DNS서버를 설정하는 파일</li>
  <li>nameserver항목에 지정된 IP주소로 질의(Query)하게 됨</li>
  <li>만약에 자기자신이 DNS서버라면 자신의 IP주소를 입력하면 됨(루프백IP도 될 듯)
→ 근데 만약 order bind라고 설정하고 이 /etc/resolv.conf에 내 IP를 적은 경우 결국 내 컴퓨터에 해당 도메인에 대한 IP정보 파일이 있어야하는거 아닌가? 없으면 계속 뱅뱅 돌기만 할 거 같은데</li>
</ul>

<p>우선순위는 맨 첫번째 nameserver항목에 지정된 IP주소로 질의하게 됨</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82836365-56e73c80-9f01-11ea-9c42-462582e87a8b.png" alt="image" />  <br />
search는 문자로서 찾는것을 의미한다.(정확히 무슨 의미인지는 아직 잘..)
kt - kns.kornet.net(168.126.63.1)에 물어보는 것임. 해당 IP는 고정되어있다.</p>

<p>두 nameserver값 다 막혀있다면 인터넷 불가능. 우리나라의 DNS서버가 다 막혀있다면?
google의 공개 DNS서버 8.8.8.8 이 있다. 다만 속도는 느리다. 미국쪽에 질의하는 것이므로.
→ 하지만 IP주소를 통한 사이트 접근은 가능할 것이다. 특정 도메인에 상응하는 IP주소를 알고만 있다면 DNS를 쓸 필요는 없으므로.. /etc/hosts 에다가 다 적어주면 nameserver 막혀있어도 그 파일에 적혀있는 도메인주소로는 접속이 가능 할 것</p>

<p>나 스스로에게 질의를 하게 하려면 맨 앞쪽에 작성해주자.. 저 kt DNS서버를 통해 질의를 모두 마치므로(이미 밖으로 나가서 답을 찾으려 하므로) 우리의 자체 DNS까지 안오게 됨</p>

<p>다른 설정파일인 /etc/named.conf 및 /etc/named.rfc1912.zones는 현재 존재하지 않는다.
bind 패키지 설치 유무를 확인 → rpm -qa | grep bind
4개는 존재하는데 정말 필요한 것이 존재하지가 않는다. 패키지명은 bind로 시작하므로 yum install bind* 로 설치하자
→ 의존성으로 postgresql-libs 패키지가 존재하는데 기억해두자. rpm으로 bind 패키지를 직접설치할 경우 꼭 먼저 설치를 해줘야 한다.</p>

<p>설치후에는 bind패키지는 총 15개가 된다. rpm -qa | grep bind | nl 을 통해 확인 가능하다.(17개가 나오는데 2개는 다른 것)
설치를 하면 /etc/named.conf와 /etc/named.rfc1912.zones가 존재한다.</p>

<p>4)	/etc/named.conf</p>
<ul>
  <li>named(daemon-서비스)의 설정파일</li>
  <li>각 도메인별 zone(영역) 파일을 지정하는 역할</li>
  <li>파일의 구성은 구문과 주석문으로 구성이 되어있으며 구문은 DNS 서버 구동시 반드시 중요하므로 임의로 수정하거나 삭제를 하면 안됨</li>
</ul>

<p>vi /etc/named.conf를 보자. 주석이 //로도 되어있음. :se nu로 줄표시
13줄 : 네임서버의 포트 번호와 접근할 수 있는 IP주소를 설정하는 항목. DNS는 포트가 53번이다. UDP와 TCP 통신을 다 한다.
현재 IP는 루프백으로 되어있는데 컴퓨터 자기자신의 IP로 되어있다. 
내부와 외부를 포함하는 IP값이 있는데, ‘any’라는 값으로 설정을 하자. 현재상태로는 다른 사람들이 내 DNS에 질의를 하지 못함
any; 로 바꿔놓자. 이러면 외부사람들도 내 DNS서버에 53번포트로 접근가능하다.</p>

<p>밑의 14줄.. IPv6는 쓰고있지 않아서 냅둬도 되며 쓰는 경우 any;로 바꿔야 함</p>

<p>15줄 : zone(영역) 파일이 기본적으로 저장되어있는 기본 디렉토리 경로(위치)를 지정
→ /var/named 라는 값으로 되어있는데 해당 디렉토리 하위에는 zone 파일들이 많이 있다.</p>

<p>16줄 : 정보가 갱신될 때 dump 파일을 지정
17줄 : 네임서버의 통계자료 파일을 지정
18줄 : 네임서버의 메모리 통계자료 파일을 지정
19줄 : 허용할 질의. 네임서버는 하나의 네임서버만 있는 것이 아니므로 하나의 DNS 서버에는 여러개의 네임서버를 가져올 수 있으므로 이를 허용 할 경우 IP 주소나 네트워크 대역을 지정
내부와 외부를 포함하는 값인 ‘any’라는 값으로 설정을 함
해놓지 않으면 외부에서 내 서버로 질의 불가능해짐</p>

<p>31줄 : 재귀, 되풀이 - 외부에서 현재의 네임서버를 지정해서 사용할 수 있게 할 것인지의 허용 여부
기본값으로 yes인데, 외부에서 현재 내 네임서버에 질의 시 그 결과값을 받을 수 있도록 허용, no면 허용하지 않겠다를 의미한다.
(참고로 DDos 공격에 대비하여 no로 보안상 설정을 함)
찾아보니.. 내가 1차 네임서버인 경우 어떤 도메인에 대해 2차 네임서버를 거치고 3차, 4차까지 갔는데도 답을 찾지 못한 경우 나에게 다시 돌아와 또 질의를 하게 할 것인지의 여부라고 하는 것 같다.</p>

<p>45~50줄 : 디버그 관련 로그 설정</p>

<p>52~55줄 : 루트 도메인(.) 설정
type이 hint라는 것은 루트 도메인을 의미
file 이름이 named.ca라는 것은 루트도메인 정의파일을 지정
/var/named/named.ca 에 있다. 잘못건드리면 루트도메인에게 못 물어본다.
13대의 DNS서버에 대해 정의되어있다.(A~M이라는 알파벳으로 정의되어있음)
→ 내가 DNS서버라고 치자. 누군가가 내 IP를 DNS서버로 지정하고 도메인에 대한 IP를 요구를 하게 될 것이다. 만약 이 named.ca를 잘못 건드리면 내가 가지고 있지 않은 도메인정보에 대해 root DNS 서버에 물어봐야하는데 그걸 못하게 됨(로컬 DNS서버로서의 제 구실 불가능)</p>

<p>57줄과 58줄을 보면 include가 있는데 해당 파일들을 포함하겠다는 것이 됨. 디렉토리를 포함한다면 include dir을 쓴다.</p>

<p>57, 58줄 : /etc/named.conf설정파일에 /etc/named.rfc1912.zones와 /etc/named.root.key 파일을 포함시키겠다.
→ 따라서 어떤 추가적 설정이 필요하다면 /etc/named.conf에 바로 해도 되지만 /etc/named.rfc1912.zones에 해도 된다.</p>

<p>:wq로 저장 후 종료</p>

<p>이제는 /etc/hosts를 쓰는게 아니라 존이라는 개념을 통해 네임서버에서는 각각의 도메인 주소를 관리하는 것 같다. 그 관리의 영역을 zone이라고 하며 각각의 도메인에 대해 zone파일로 관리를 진행하는 것으로 보인다.
→ 웹브라우저에 도메인 입력시 먼저 자체 PC의 hosts 파일에 질의 후 없을 시 로컬DNS 서버로 1차 질의를 진행하는 방식인 것 같다. 그 때 그 DNS서버가 관리하는 그 영역 범위를 zone이라고 하는 것 같음
google에 dns zone이란? 검색해봄. http://hack.pe.kr/115 참고.
google에 zone파일이라고도 검색해봄. https://www.linux.co.kr/home/lecture/?leccode=374 참고
⇒ 역시나 DNS서버가 가지고 있어야 할, 도메인에 대한 IP 데이터베이스라고 보인다.</p>

<p>5)	 /etc/named.rfc1912.zones</p>
<ul>
  <li>/etc/named.conf 설정파일의 확장개념으로서 외부설정을 포함하고자 할 때 사용</li>
</ul>

<p>vi /etc/named.rfc1912.zones로 들어가자. se nu로 줄번호 생성</p>

<p>forward zone(정방향 영역)과 reverse zone(역방향 영역)을 설정</p>

<p>forward zone(정방향 영역)은 Domain(문자)을 IP(숫자)로 바꿈
reverse zone(역방향 영역)은 IP(숫자)를 Domain(문자)로 바꿈
→ 컴퓨터는 숫자만을 아므로 정방향영역이 더 중요하다. 역방향영역은 잘 안씀. 스팸메일등에 대해 역추적시 역방향을 쓰기는 함(IP로 도메인추적?)</p>

<p>13줄 ~ 23줄
컴퓨터 자기자신에 대한 정방향설정이 기본값으로 되어있다.</p>

<p>forward zone 설정
기본 구문은 13줄 ~ 17줄, 19줄 ~ 23줄이 있음. 수정하거나 삭제하면 안됨</p>

<p>새로운 forward zone 설정을 위해 별도 추가하면서 작업
24줄 밑에 새 줄을 생성</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82836394-6070a480-9f01-11ea-89c2-ffe176de90a7.png" alt="image" />   <br />
25줄 : zone 을 쓰고 “” 안에 도메인 네임을 지정(입력)
→ 왜 www는 안쓰는 것일까. 호스트네임부분이라 여러개가 존재할 수 있으니 그런 것들은 zone파일 내에서 쓰는 것일까 아니면 결국 호스트네임에 대한 결과값은 kgitbank 자체에서 관리하는 부분일뿐이니 DNS서버입장에서는 그냥 도메인네임까지만 관리를 하는 것뿐인가. 도메인 네임에 대해서만 관리를 하고 www에 대한 결과값은 결국 kgitbank서버로 가서 받아야하니까.. 예를 들어 video.kgitbank.co.kr이라는 것도 있다고 했을 때 같은 zone으로서 처리를 하고 결국 video라는 그 특정 호스트네임에 해당하는 결과값은 kgitbank 서버에서 받아와야하므로 작성하지 않는건가</p>

<p>26줄 : type은 master (우리는 1차 네임서버를 구축할 것이므로 master라고 작성한다)
master는 1차 네임서버(혹은 주 네임서버)를 의미(아까 hint는 루트도메인을 의미)</p>

<p>참고로 type이 slave라 하면 2차 네임서버(혹은 보조 네임서버)를 의미
→ 만약 다른 컴퓨터에 2차네임서버를 구축하고 싶다면 해당 컴퓨터의 파일에서 이 zone에 대한 값을 작성시 type부분에는 slave라고 작성</p>

<p>27줄 : file “” 안에 미리 파일명을 지정(선언)
이 때, 파일명은 forward zone 정의 파일의 이름이 됨
파일명은 정해지지 않았으므로 자유롭게 지정해도 되지만 나중에 진짜 zone설정파일을 만들 때에는 저 이름대로 만들어야 한다.</p>

<p>28줄 : 혹시라도 1차 네임서버(주 네임서버) 존재시 별도로 2차 네임서버(보조 네임서버)를 구축한다면 동기화 할 slave 서버의 IP주소를 지정하거나 내부와 외부를 포함하는 값인 ‘any’라는 값을 지정해주면 됨
즉 2차 네임서버가 존재할 때 그 2차네임서버에서 1차 네임서버의 값을 통해 업데이트를 진행할 수 있게 하려면 masterDNS에 해당하는 주 네임서버에서 이 부분에 slave DNS 보조 네임서버 IP를 입력해야 2차 네임서버에서 업데이트가 가능함 ( 업데이트를 위한 접근 허용 IP 작성부분이라고 보면 될 듯)</p>

<p>별도로 아래와 같이 또 다른 항목을 추가함
allow-transfer { none; };
이 때에도 none을 동기화 할 slave 서버의 IP 주소를 지정하거나 내부와 외부를 포함하는 값인 ‘any’라는 값을 지정
→ 이것도 allow-update항목과 비슷하다. 외부에서 내 zone파일을 취해갈 수 있게 할 것인지, 그 허용할 IP를 적어주는 부분이다. 보조DNS서버가 있다면 그 보조서버IP만을 작성하고, 그게 아니라면 none으로 하는 것이 보안상 적절하다.</p>

<p>29줄 : }; 25줄에 {로 열었으므로 닫아줌</p>

<p>31줄은 IPv6에 대한 설정임
31줄을 기준으로 위의 두 zone은 정방향이며 아래의 두 zone은 역방향이다.
→ 31줄 또한 역방향으로 보인다. 내 루프백 IPv6에 대한 도메인 값을 지정하는 부분으로 보임</p>

<p>reverse zone 설정
기본 구문은 31줄~35줄, 37줄~41줄이 있음(수정하거나 삭제하면 안됨)
→ kgitbank에 대한 정방향존을 추가했으므로 현재 37줄 ~ 41줄, 43줄 ~ 47줄</p>

<p>새로운 reverse zone 설정을 위해 별도 줄 추가(49번째 줄 생성)</p>

<p>아까 forward zone을 만들 때 도메인네임구간을 적었고, 호스트네임구간은 적지 않았다. 이와 마찬가지로 reverse zone을 작성할 때에도 네트워크 ID부분만을 적어야한다. → 아까 말했듯 www.kgitbank.co.kr 에서 www에 대한 진짜 값은 kgitbank에서 받아와야 하는데.. 이처럼 IP를 도메인으로 매핑할 때에도 DNS서버는 네트워크ID라는 개략적인 부분만 담당하는건가</p>

<p>다만 reverse zone이므로 거꾸로 작성해야한다. → 이건…흠</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82836421-69617600-9f01-11ea-909c-e7c7b9f38c3f.png" alt="image" />   <br />
49줄 : “” 안에는 forward zone에서 도메인 네임과 매핑(mapping, 변환) 되는 부분인 Network ID를 거꾸로 입력. 예를 들어 우리 컴퓨터 IP는 192.168.52.x인데 이에 대한 Network ID부분은 192.168.52 이므로 이걸 거꾸로 52.168.192라고 작성하면 된다.</p>

<p>50줄 : type은 master이다. 1차 주 네임서버이므로 master로 작성</p>

<p>51줄 : file “” 안에 미리 파일명을 지정(선언)
이 때 파일명은 reverse zone 정의 파일의 이름이 됨(역시나 이름은 자유)</p>

<p>52줄 : 주 네임서버를 만드는 것이므로 none이라고 작성한다.</p>

<p>53줄 : }; 49줄에 { 를 열었으므로 닫아줌</p>

<p>:wq로 저장하고 종료</p>

<p>이제 실질적인 설정파일(zone파일) 정의를 또 해줘야한다.</p>

<p>네임서버(Name Server)</p>
<ul>
  <li>도메인의 정보를 소유하고 클라이언트에게 질의에 대한 응답을 수행</li>
  <li>DNS라고도 부를 수 있음</li>
  <li>자신이 소유한 도메인 zone(영역)에 대한 응답</li>
</ul>

<p>리소스 레코드(Resource Record)</p>
<ul>
  <li>하나의 도메인 네임이 갖는 속성 정보를 지정하는 수단
→ 즉, 어떤 도메인 네임에 대한 속성 정보를 지정 할 때 이 리소스 레코드라는 것을 이용한다?</li>
</ul>

<p>종류
SOA(Start Of Authority) : 권한(인증)의 시작
NS(Name Server) : 네임서버를 지정
A(Address) : 특정 서버와 도메인이 IP주소를 지정(부여)
MX(Mail Exchanger) : 메일 서버를 설정
CNAME(Canonical Name) : 도메인을 문자로서 별도로 지정(Alias, 별칭)
PTR(Pointer) : reverse zone(역방향 영역)에서 사용하는 리소스 레코드로서 IP주소(숫자)를 Domain(문자)로 매핑(변환)</p>

<p>→ 정방향을 설정할 때에는 A라는 것을 이용하고 역방향 설정시에는 PTR을 이용</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#linux" class="page__taxonomy-item" rel="tag">Linux</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-05-26T00:00:00+09:00">May 26, 2020</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Linux2_day14%20http%3A%2F%2Flocalhost%3A4000%2Flinux%2FLinux2_day14%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Flinux%2FLinux2_day14%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Flinux%2FLinux2_day14%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/linux/Linux2_day13/" class="pagination--pager" title="Linux2_day13
">Previous</a>
    
    
      <a href="/linux/Linux2_day15/" class="pagination--pager" title="Linux2_day15
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/linux/Linux_day9/" rel="permalink">Linux_day9
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  11 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">디렉토리 삭제 rmdir은 내부가 비어있는 경우에만 디렉토리 제거 가능 → 안에 파일이 있어도 삭제 할 수 있는 옵션은?
→ 없다. man rmdir 및 rmdir –help 로 내부 옵션 살폈는데 안에 파일이 있어도 삭제할 수 있는 옵션은 존재하지 않는다.
결국 rm -r 을 사...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/linux/Linux_day8/" rel="permalink">Linux_day8
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  9 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">putty접속 안됐으나 VMware 가상네트워크설정에서 NAT에 있어서 두가지 체크사항 건드리니까 다시 됨. 한가지만 체크되어있었는데 먼저 체크 푼 다음에 설정창 껐다가 다시 키고, 체크사항 두개 다시 체크한 뒤에 설정창 끔.  OS GUI에서도 네트워크 설정부분 껐다가 켰다. 아...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/linux/Linux_day7/" rel="permalink">Linux_day7
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">vi(Visual Editor) → vi-sual editor. 줄여서 VI Editor 라고도 한다.
한 줄씩 편집하는 줄 단위 편집기가 아니라 한 화면을 편집하는 비주얼 에디터라는 뜻에서 유래 → 그러면 줄 단위 편집기도 있었다는건가???
간결하면서도 강력한 기능을 제공
GUI...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/linux/Linux_day6/" rel="permalink">Linux_day6
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  8 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">논리연산자
이전시간에 우리는 논리연산자 &amp;&amp;와 ||를 배웠다.
a &amp;&amp; b → a가 실행되면 b도 실행. a가 실행되지 않으면 b도 미실행
a || b → a가 실행되면 b는 미실행, a가 미실행되면 b는 실행
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/ictechgy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2020 dev blog. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>







    
  <script>
    var disqus_config = function () {
      this.page.url = "http://localhost:4000/linux/Linux2_day14/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/linux/Linux2_day14"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://ictechgy-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
