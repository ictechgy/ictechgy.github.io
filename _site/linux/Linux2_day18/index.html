<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="ko" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Linux2_day18 - 개발 끄적끄적</title>
<meta name="description" content="DNS 셋팅해주자. systemctl restart named.service 를 해서 DNS 네임서버를 실행 vi /etc/resolv.conf 로 내 컴퓨터가 어떤 페이지를 찾아갈 때 나 스스로에게 먼저 질의하도록 설정 ">


  <meta name="author" content="JJanghong">


<meta property="og:type" content="article">
<meta property="og:locale" content="ko_KR">
<meta property="og:site_name" content="개발 끄적끄적">
<meta property="og:title" content="Linux2_day18">
<meta property="og:url" content="https://ictechgy.github.io/linux/Linux2_day18/">


  <meta property="og:description" content="DNS 셋팅해주자. systemctl restart named.service 를 해서 DNS 네임서버를 실행 vi /etc/resolv.conf 로 내 컴퓨터가 어떤 페이지를 찾아갈 때 나 스스로에게 먼저 질의하도록 설정 ">



  <meta property="og:image" content="https://ictechgy.github.io/assets/images/photo-hangang.jpeg">





  <meta property="article:published_time" content="2020-05-26T00:00:00+09:00">





  

  


<link rel="canonical" href="https://ictechgy.github.io/linux/Linux2_day18/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "dev blog",
      "url": "https://ictechgy.github.io/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="개발 끄적끄적 Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          개발 끄적끄적
          <span class="site-subtitle">개발공부</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="">About</a>
            </li><li class="masthead__menu-item">
              <a href="/about/"></a>
            </li><li class="masthead__menu-item">
              <a href="">연도별</a>
            </li><li class="masthead__menu-item">
              <a href="/posts/"></a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">토글 메뉴</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/photo-avatar.jpeg" alt="JJanghong" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">JJanghong</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>공부중입니다.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">팔로우</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Republic of Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:ictechgy@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/ictechgy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Linux2_day18">
    <meta itemprop="description" content="DNS 셋팅해주자.systemctl restart named.service 를 해서 DNS 네임서버를 실행vi /etc/resolv.conf 로 내 컴퓨터가 어떤 페이지를 찾아갈 때 나 스스로에게 먼저 질의하도록 설정">
    <meta itemprop="datePublished" content="2020-05-26T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Linux2_day18
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  10 분 소요

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>DNS 셋팅해주자.
systemctl restart named.service 를 해서 DNS 네임서버를 실행
vi /etc/resolv.conf 로 내 컴퓨터가 어떤 페이지를 찾아갈 때 나 스스로에게 먼저 질의하도록 설정</p>

<p>그리고 웹서버 또한 가동시켜주자. systemctl restart httpd.service
→ 파이어폭스에서 내 도메인으로 내가 만든 페이지 잘 나온다.
⇒ 윈도우 익스플로러에서 키는건.. 윈도우의 DNS는 kt로 잡혀있기때문에 당연히 안됨</p>

<p>vi /etc/httpd/conf/httpd.conf 로 아파치 웹 서버 설정파일로 다시 들어가자</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837274-8c8d2500-9f03-11ea-8975-4214e197c878.png" alt="image" /> <br />
164줄 : 웹 사이트의 초기 페이지 문서로 어떤 파일을 사용할 것인지에 대한 결정을 하는 지시자. 기본값으로 index.html
적혀진 순서대로 파일을 읽어들이며 적혀진 순서대로 파일이 존재하지 않으면 Options 지시자에 있던 Indexes 설정에 의해 내부 파일 목록이 모두 보이게 된다.
→ 다른 파일이 뜨도록 하고 싶다면 ‘DirectoryIndex index.html’ 뒤에 한칸 띄고 새 파일 명을 작성해주도록 한다. 
예를 들어 ‘DirectoryIndex index.html index2.html’ 로 작성했다고 하자. 1순위로 index.html을 읽어들이고 그게 없다면 index2.html을 읽으며 둘 다 없다면 Indexes 설정에 의한 결과창이 뜬다. (index2.html을 띄우고 싶다면 해당 디렉토리에 index.html이 없어야 한다.)</p>

<p>/etc/httpd/conf/httpd.conf 가 아닌
/etc/httpd/conf.d/userdir.conf 에 대하여</p>
<ul>
  <li>웹 서버에서 관리자 이외에 다른 사용자 계정으로 홈페이지를 운영하고자 할 때 일반 사용자 계정의 웹 문서 디렉토리를 지정하는 파일
참고로, CentOS 6.x 에서는 /etc/httpd/conf/httpd.conf 파일에서 설정했었음. 7에서 흩어진 것중 하나임</li>
</ul>

<p>vi /etc/httpd/conf.d/userdir.conf 로 들어가서 :se nu</p>

<p>17줄 : 이 설정을 사용할 사용자 계정을 활성화 또는 비활성화 하는 줄</p>

<p>설정방법
UserDir disabled(기본값)
→ 모든 사용자 계정 비활성화</p>

<p>UserDir disabled 계정명
→ 지정한 사용자 계정을 비활성화
⇒ 나머지 계정들은 활성화?</p>

<p>UserDir enabled
→ 모든 사용자 계정을 활성화</p>

<p>UserDir enabled 계정명
→ 지정한 사용자 계정을 활성화</p>

<p>여러개의 계정을 지정하고자 하는 경우 띄어쓰기를 구분자로 삼아 여러개 입력 가능하다.</p>

<p>24줄 : 만약 UserDir 이 enabled 된다면, 사용자계정의 홈 디렉토리 하위에 웹 문서 기본경로를 지정하는 줄</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837285-94e56000-9f03-11ea-9fba-951eba4d3329.png" alt="image" /> <br />
현재 위와같이 되어있는데 이러면 /home/사용자계정 하위에 파일이름이 public_html 로 되어있어야 한다는건가? 아니면 저건 그냥 보여주기로 만들어놨을뿐 따로 이름을 작성해야하는건가</p>

<p>실습1.
apple 사용자 계정을 이용하여 인터넷 내용을 출력해보기. 이 때, apple 사용자 홈 디렉토리 생성경로는 /home 하위임</p>

<p>위 설정이 다 된 후 확인할 때에는 아래를 참고!
http://www.내이름.com/~계정명 으로 치면 내용이 나온다.
→ ‘~계정명’ 이 의미하는 것은 ‘/home/계정명’ 을 의미한다.</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837293-9b73d780-9f03-11ea-9656-d2595d3f6847.png" alt="image" /> <br />
먼저 설정에서 위와같이 바꿈
그리고 systemctl restart httpd.service 를 한 뒤에 useradd apple 을 하고 passwd apple 로 비밀번호를 생성해주었다.
su - apple 로 apple계정으로 들어간 뒤 홈디렉토리 하위에 index.html을 touch로 만든 후 vi 로 내용을 작성해주었다.</p>

<p>다시 root계정으로 돌아온 뒤에 파이어폭스를 키고 www.jinhong.com/~apple 로 접속해보았다. 뜨지 않는다.</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837302-a0d12200-9f03-11ea-958c-612a630cf0a8.png" alt="image" /> <br />
이게 뜸. 즉, 접근허용이 나지 않았다는건데 그래서 vi /etc/httpd/conf/httpd.conf 로 들어갔다.
→ /home/apple/index.html 을 불러오는데 /home 과 /home/apple 의 접근권한이 있지 않아서 Forbidden이 뜬 것으로 판단함</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837315-a75f9980-9f03-11ea-9a44-6acab6abc41b.png" alt="image" />  <br />
위의 내용을 추가해줌. 사실 원래 178~182 줄만 썼었는데도 Forbidden 떠서 173~176줄도 추가했음</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837327-ad557a80-9f03-11ea-8040-17c19c27b465.png" alt="image" />   <br />
그런데도 안된다. 접근을 허가하도록 해줬는데도 왜 안되지??</p>

<p>/etc/httpd/conf.d/userdir.conf 에서
UserDir index.html 을 만들었던 것을</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837340-b21a2e80-9f03-11ea-8177-45c0430cf39f.png" alt="image" />   <br />
이렇게 해야하나?
→ 이랬는데도 안된다.</p>

<p>풀이</p>

<p>skel 이용하여 사용자 계정 생성
cp -r /etc/skel /userdirskel
mkdir /userdirskel/public_html</p>

<p>useradd -m -k /userdirskel apple
→ 이렇게 하면 /home/apple 하위에 skel 파일들이 잘 생겨있다.</p>

<p>useradd 에서 -mk 옵션은 스켈을 지정한 디렉토리것으로 쓰겠다는 옵션이고 이에 따라 /userdirskel 에 있는 파일들을 가지고 apple 계정의 skel 을 구성시킨 것이다.</p>

<p>useradd 에는 -b(base)와 -d 가 있었는데 -b는 지정한 경로 하위에 홈 디렉토리를 새로 만드는 명령어이고  -d는 지정한 경로를 홈 디렉토리로 만들겠다는 것이다.
-b 이 위치 아래에 사용자 이름으로 된 홈디렉터리가 만들어집니다.
  -d 이 위치 아래에 사용자 데이터가 저장됩니다.
-d를 쓸 때 지정한 경로가 존재하지 않으면 홈디렉토리가 만들어지지 않으므로 -m옵션도 함께 사용하도록 하자.(이를테면 -d 로 /a/b 를 지정했는데 /a 만 존재하는경우 b디렉토리가 사용자 계정의 홈 디렉토리가 돼야하는데 그게 안됨. 이 경우 -m까지 쓰면 /a/b를 만들어줌)</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837356-ba726980-9f03-11ea-893d-1207a4bd40bc.png" alt="image" />   <br />
이렇게 해놓은건 일단 유저 홈 디렉토리에 대해 활성화를 해놓았다는 것이고, 
UserDir public html 이라고 해 놓은 것은 /home/사용자계정/public_html 디렉토리 하위의 index.html 을 보게 하겠다는 것이다.</p>

<p>따라서 위와같이 작성하고 사용자계정과 사용자 계정의 홈 디렉토리를 만든다. 사용자 계정의 홈 디렉토리 하위에 public_html 디렉토리가 없다면 추가적으로 만들고 그 하위에 index.html을 생성하자. (index.html 이 존재하지 않는다면 웹브라우저에서는 NotFound가 뜬다.)</p>

<p>여기까지 했는데 이번에는 Forbidden이 뜬다. 접근권한 permission이 존재하지 않는다고 뜬다. 
→ 이것은 사용자 홈디렉토리 /home/apple 에서 apple 디렉토리의 허가권 및 public_html 디렉토리 허가권과 index.html 허가권에 있어서 문제가 발생한 것이다.
웹브라우저로 접근하는 것이므로 디렉토리의 허가권에 있어서 other 에 x가 있어야 하며 index.html 에는 other에 r이 있어야 한다.
⇒ 사용자계정 홈 디렉토리와 public_html 디렉토리의 other에 x권한이 없다면 있도록 해주고 index.html 파일 자체에 r권한이 있게 만들어주자. 그러면 웹브라우저에서 내용이 잘 보이게 된다.
(내가 한 것처럼 &lt;Directory&gt;를 작성해주는 것이 아니었음 → 사실 /home/*/public_html 에 대해서는 해당 파일-/etc/httpd/conf.d/userdir.conf 의 아래쪽에 보면 이미 &lt;Directory&gt; 구문으로 기본 허가가 되어있는 상태이다.)</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837363-c100e100-9f03-11ea-98f3-7e9a39ef23a3.png" alt="image" />
/etc/httpd/conf.d/userdir.conf 에 위와같은 내용이 있는데 내용을 해석해보자면
사용자계정의 홈디렉토리는 기본 700 허가권인데 711은 만들어줘야 하며 홈계정 하위에 있을 디렉토리인 public_html 디렉토리는 755로 만들어달라는 것이다. 그리고 그 하위의 웹문서파일은 최소한 읽기가능으로 있어야 한다는 뜻. 
즉 이문제는 허가권(permission) 문제였다.</p>

<p>→ 근데 UserDir public_html 로 해둔 상태에서 바로 홈 디렉토리 /home/apple 하위에 public_html 이라는 이름으로 웹문서 파일이 있는 경우 내용이 잘 보임(허가권은 apple 에 대해서만 작업)</p>

<p>UserDir public_html 항목을 주석처리하면 홈디렉토리 하위에 바로 index.html 둔게 작동할까 했는데 안된다. NotFound 뜸→ 홈디렉토리 자체에 대한 허가권은 건드려준 상태인데.. 홈 디렉토리에 대해 &lt;Directory&gt; 구문으로 접근허가를 또 따로 내려야하나
⇒ &lt;Directory “home/*”&gt;해줬는데도 안된다.</p>

<p>UserDir public_html 항목이 활성화 되어있는 상태에서 사용자계정의 홈 디렉토리 하위에 index.html 이 그냥 있는것도 작동은 안된다. UserDir 로 적어놓은 디렉토리가 홈디렉토리 하위에 1차적으로 존재해야 하고 그 하위에 index.html이 존재해야한다.</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837369-c78f5880-9f03-11ea-878d-29ab39213df1.png" alt="image" />
/etc/httpd/conf.d/userdir.conf 에 보면 위의 내용이 있는데, 세부 접근권한을 설정해주는 항목이 있다. 우리는 /etc/httpd/conf/httpd.conf에서 기본적으로 / 에 대해 접근을 거부해뒀기 때문에 위와같이 선택적으로 접근을 허용해줘야 한다.
이 구문은 /etc/httpd/conf/httpd.conf 에서 설정해줘도 되는 구문 아닐까</p>

<p>무튼 위의 실습풀이 해봤는데 왜 안되는거지? ..음 뭐 잘못했나. root계정으로 public_html 디렉토리랑 index.html 만들었는데 apple 계정으로 만들어야 하는 거였나.</p>

<p>실습 2.
pineapple 사용자 계정을 이용하여 인터넷 내용을 출력해보기
이 때, pineapple 사용자 홈 디렉토리 생성경로는 /fruit 하위임</p>

<p>위 설정이 다 된후 확인할 때는 아래를 참고!
http://www.내이름.com/~계정명</p>

<p>→ www.jinhong.com/~pineapple 을 주소창에 친다는 것은
/fruit/pineapple/public_html/index.html 으로 접근한다는 것</p>

<p>vi /etc/httpd/conf.d/userdir.conf 에서
UserDir enabled 가 되어있는지 확인하자.
UserDir public_html 도 활성화되어있는지 확인한다.</p>

<p>systemctl restart httpd.service를 하고 주소창에 www.jinhong.com/~pineapple 을 해보면 아직 아무것도 안뜬다.</p>

<p>mkdir /fruit 를 해준다. 
useradd -d /fruit/pineapple -m -k /userdirskel pineapple 로 계정 생성
(또는 pineapple 디렉토리를 fruit 하위에 먼저 만든 뒤 useradd -d /fruit/pineapple pineapple 해줘도 되고 간단하게 useradd -b /fruit pineapple로 만들어줘도 된다)</p>

<p>일단 홈 디렉토리에 대해 허가권을 변경한다. (기본 700생성될테니)
chmod 711 /fruit/pineapple
홈디렉토리 하위에 public_html 디렉토리가 존재하는지 확인하고 허가권도 조정해주자.(other에 x가 기본적으로 존재하는 상황이라 안건드려도 되긴 함)</p>

<p>touch /fruit/pineapple/public_html/index.html 로 파일을 만들고 vi로 아무거나 작성해주자.</p>

<p>그리고 주소창에 www.jinhong.com/~pineapple 을 해보면 아직도 안뜬다.
→ 왜? /fruit/pineapple/public_html/index.html에 접근한게 아닌가? 허가권도 조정해줬고 pineapple 홈 디렉토리인 /fruit/pineapple 하위에 public_html도 만들었으며 그 안에 index.html도 만들어줬는데??</p>

<p>이는.. /etc/httpd/conf.d/userdir.conf의 문제이다.</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837376-cceca300-9f03-11ea-82b4-83c6174619cf.png" alt="image" /> <br />
이런 부분이 있다. 즉 저 부분에 대해 접근권한을 풀어주는 부분이다.</p>

<p>위의 내용처럼 /fruit에 대한 것도 접근권한을 풀어줘야 한다.</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837382-d37b1a80-9f03-11ea-9254-42b42dd31f52.png" alt="image" /></p>

<p>이제 이렇게 하고 systemctl restart httpd.service 를 하면
www.jinhong.com/~pineapple 했을 시 내용이 잘 나오게 된다.</p>

<p>vi /etc/httpd/conf.d/userdir.conf 로 다시 들어가자.</p>

<p>32~36줄은 /home/*/public_html 디렉토리에 대한 기본 옵션과 권한을 설정하는 항목</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837389-da099200-9f03-11ea-85c0-8f7ad1146039.png" alt="image" />  <br />
FileInfo는 AccessFileName 지시자에 명시한 파일에 대하여 AddEncoding, AddLanguage, AddType, DefaultType, ErrorDocument, LanguagePriority 등과 같은 문서유형을 제어하는 지시자 사용을 허용</p>

<p>AuthConfig는 AccessFileName 지시자에 명시한 파일에 대하여 AuthDBMGroupFile, AuthDBMUserFile, AuthGroupFile, AuthName, AuthType, AuthUserFile, require 등과 같은 클라이언트 인증지시자의 사용을 허용
htpasswd 유틸리티를 이용하여 특정 디렉터리의 접근은 AccessFileName에 명시한 파일(.htaccess)로 제어하고자 할 때 해당 디렉터리내에 이 값을 주로 사용(디렉터리 인증)</p>

<p>Limit는 AccessFileName 지시자에 명시한 파일에 대하여 allow, deny, order 등과 같은 호스트 접근을 제어하는 지시자 사용을 허용</p>

<p>MultiViews는 웹 브라우저의 종류나 웹 문서의 종류에 따라서 가장 적합한 페이지를 보여줄 수 있도록 하는 설정</p>

<p>GET은 서버에서 자료를 가져오는 요청(중요하지 않은 자료를 URL을 통해 요구하고 받는 방식)
POST는 서버에 정보를 저장하도록 요청(중요한 데이터를 암호화하여 통신하는 방식)</p>

<p>만약 /etc/httpd/conf.d/userdir.conf 에서 ‘UserDir public_html’을 ‘UserDir test’로 해놓은 경우 /home/<em>/test 하위에 index.html을 둔 경우 허가권만 건드려도 나오기는 한다고 함. → 뭐지?? &lt;Directory “/home/</em>/test”&gt;를 만들지 않아줘도 되는건가.
그런데 &lt;Directory&gt; 부분에서 설정한 것은 현재 /home/*/public_html에 대한 것이니, test디렉토리에 대해서는 이 옵션값들이 적용이 안된다고 함(test 디렉토리 하위에 index.html이 없는경우 이전처럼 어떤 파일이 있는지 등의 목록 출력방식이 먹히지 않음)</p>

<p>⇒ 결론. 리눅스 서버 일반 사용자로 웹서버 보여주려면 허가권 및 &lt;Directory&gt; 설정을 건드리자</p>

<p>/etc/httpd/conf.d/autoindex.conf</p>
<ul>
  <li>특정 디렉토리 주소를 일부 페이지처럼 사용할 수 있게 설정하는 파일
참고로 CentOS 6.x에서는 /etc/httpd/conf/httpd.conf 파일에서 설정</li>
</ul>

<p>21줄 : /icons/(fakename) “/usr/share/httpd/icons/”(realname)
fakename은 realname으로 설정된 경로를 마치 웹 페이지 path주소처럼 사용하기 위해 속이는 이름
→ 예를 들어 www.jinhong.com/icons 라고 들어가서 뭔가 뜬다면 보통은 DocumentRoot 하위에 icons 디렉토리가 있겠구나, 그리고 그 하위에 index.html이 있겠구나 하겠지만 그게 아니라는 거임</p>

<p>⇒ 어제 내가 건드렸던 부분 비슷. 7에서도 /etc/httpd/conf/httpd.conf 에서 설정 가능</p>

<p>realname은 fakename으로 사용해서 내용을 출력하기 위한 웹 문서(index.html)가 들어있는 디렉토리</p>

<p>역시나 이 /usr/share/httpd/icons/ 에 대해서도 &lt;Directory&gt;로 경로 접근 풀어줘야한다.
허가권은?</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837399-e0980980-9f03-11ea-9ffc-b4f8b748c1e1.png" alt="image" />  <br />
위와같이 작성해주었다.
/real/name/index.html 을 보여주는데 이것을 주소창에서는 /mango/ 라고 속이게 된다.
복사붙여넣기는 커서위치로부터 복사할 줄갯수+yy 및 p 버튼</p>

<p>:wq로 저장 후 종료</p>

<p>일단 systemctl restart httpd.service를 해보자. /real/name이라는 경로는 일단 없지만 오류는 나지 않는다.
파이어폭스로 www.jinhong.com/mango 하면 Not Found 뜬다.</p>

<p>mkdir -p /real/name 한 뒤에 touch /real/name/index.html 을 한 뒤에 vi 로내용 편집
그리고 다시 파이어폭스로 접근해보자. www.jinhong.com/mango
→ 여전히 404 NotFound가 뜬다.
www.jinhong.com/mango/ 로 맨 뒤에 슬래시가 포함되어야한다.</p>

<p>기본 DocumentRoot 나 일반사용자계정용으로 UserDir 썼던 것을 이 Alias 로 대체하여 사용할 수 있다. (index.html 의 파일 위치를 속이기가 가능함)</p>

<p>Virtual Host(가상 호스트)</p>
<ul>
  <li>웹 서버에서 기본적으로 존재하는 주 호스트와는 별도로, 어떤 설정에 의해 추가된 웹 호스트</li>
</ul>

<p>한대의 컴퓨터나 IP주소로 여러 도메인의 웹 서버(호스트)를 운영하려고 할 때 사용</p>

<p>→ 기본적으로 어떤 도메인네트워크에 있어서 각각의 호스트들은 기계가 따로 존재한다. 즉 naver.com 이라는 도메인에 있어서 www 를 담당하는 호스트(네임)머신과 blog, kin, cafe 등은 다 운용하는 기계가 따로 있다는 것이다. 그런데 가상호스트를 이용하면 하나의 머신에서도 여러 호스트네임에 대해 운용을 할 수 있게 된다. (한 호스트머신에서 www와 cafe 등을 동시에 운용 가능)</p>

<p>이름 기반 가상 호스트</p>
<ul>
  <li>하나의 IP주소에서 여러 이름의 가상 호스트를 각각 운용</li>
</ul>

<p>참고로 CentOS6.x 에서는 /etc/httpd/conf/httpd.conf 파일에서 설정했었으나 CentOS 7.x에서는 설정이나 해당 관련 파일이 존재하지 않는다.</p>

<p>준비물
touch /etc/httpd/conf.d/vhost.conf(파일명은 아무렇게 만들어도 상관은 없음)</p>

<p>DNS의 Forward Zone(정방향 영역)에서 www호스트 네임과 cafe 호스트 네임정보를 추가해놓은 상황에서 작업 → 두 호스트네임에 있어서 동일한 내 컴퓨터 IP로 설정해 놓은 상황이어야 할 듯</p>

<p>nslookup 에서 www.jinhong.com 과 cafe.jinhong.com 이 잘 나오는지 보자.
내 IP가 잘 나온다면 주소창에서 각각 저 주소들을 입력해보자. → 동일한 내용이 나온다. 이는 당연한거다. 두 주소에 대해 IP주소를 질의할 때 /etc/resolv.conf 설정에 의해 ‘나’라는 네임서버에게 먼저 물어보게 된다. 이 때 내 네임서버에서는 jinhong.com이라는 도메인에 대해 이미 등록한 상태이며 zone으로서 그것을 관리하고 있다. www와 cafe 호스트네임에 대해서는 동일한 192.168.52.149(내 IP)로 연결되는 상황이다. 따라서 주소창에 저 두 주소를 입력하면 192.168.52.149로 동일하게 연결되며 두 주소 다 웹서버의 기본 DocumentRoot의 index.html 하나가 작동하는 방식이기 때문이다.</p>

<p>vi /etc/httpd/conf.d/vhost.conf 로 들어간 뒤 :se nu</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837410-e857ae00-9f03-11ea-9231-d0f0c4d462ef.png" alt="image" />  <br />
1줄 : &lt;VirtualHost *:80&gt;
→ 모든 IP주소로서 80번포트로 가상호스트를 운용하겠다.
또는
&lt;VirtualHost 내IP주소:80&gt;
→ 지정한 내 IP주소로서 80번 포트로 가상호스트 운용하겠다.
⇒ 가상호스트를 운용할 서버의 IP를 써주면 되는 듯</p>

<p>2줄 : ServerAdmin 관리자의E-mail주소
→ 관리자의 E-mail 주소를 입력</p>

<p>3줄 : ServerName 가상호스트를생성할호스트네임(FQDN)
→ 클라이언트에게 보여줄 호스트 네임</p>

<p>4줄 : DocumentRoot 가상호스트가사용할기본디렉토리
→ 가상호스트가 사용할 웹 문서가 들어있는 기본 디렉토리 입력</p>

<p>5줄 : ErrorLog “logs/내도메인이름_error_log”
→ 웹 서버의 접근 에러사항을 기록하는 파일의 이름과 경로를 지정 (기본적으로 log라는 심볼릭 링크 디렉토리 사용)</p>

<p>6줄 : CustomLog “logs/도메인이름_access_log” common
→ 웹 서버에 접근한 원격 호스트들의 정보를 기록할 파일의 이름과 경로를 지정
log 파일의 포맷으로 common(접근정보), referer, agent, combined 등이 있으므로 반드시 저 종류 중 하나를 입력</p>

<p>7줄 : &lt;/VirtualHost&gt;</p>

<p>:wq 로 저장 후 종료</p>

<p>아직 가상호스트 데몬은 실행시키지 않는다.
위 설정이 다 되었으면 가상호스트에서 사용할 DocumentRoot의 경로를 /etc/httpd/conf/httpd.conf 파일에서 별도로 추가를 해줘야함</p>

<p>vi /etc/httpd/conf/httpd.conf 로 들어간 뒤 :se nu</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837420-ef7ebc00-9f03-11ea-9b64-b670b5e67727.png" alt="image" />  <br />
→ 가상호스트의 Document Root에 대한 접근을 허용하는 구문을 입력</p>

<p>:wq로 저장하고 나와서
이제 서비스를 재시작해보자.
systemctl restart httpd.service → 가상호스트 운용도 웹서버 운용 서비스인 httpd.service에서 주관하는 듯. 무튼 vhost.conf 로 가상호스트 쓸것이라고 했고 httpd.conf 에서 가상호스트의 DocumetRoot를 해방해준 상태이다.</p>

<p>아직까지는 /virtual/host 가 없어서 그런건지 두 주소 다 기본 DocumentRoot 의 index.html이 뜬다.
mkdir -p /virtual/host 를 한 뒤 cafe.jinhong.com 을 새로고침하면 Testing123페이지가 뜬다! 저 디렉토리에 index.html이 없기때문에..</p>

<p>touch /virtual/host/index.html 을 한 뒤 vi 로 편집 후 :wq로 저장 후 종료하자.</p>

<p>cafe.jinhong.com 페이지를 새로고침하면 내가 작성한 파일이 잘 뜬다.
→ 근데 기존의 www.jinhong.com 이 cafe.jinhong.com 의 결과를 따라간다.
기존의 DocumentRoot는 /web/server/apache 였다. 근데 www가 이걸 안보고 /virtual/host를 따라보고있음
&lt;VirtualHost&gt; 에 썼던 DocumentRoot를 따라가게 됨</p>

<p>따라서.. vi /etc/httpd/conf.d/vhost.conf 로 다시 들어가자.</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837426-f60d3380-9f03-11ea-8472-df14c69e6fb7.png" alt="image" /></p>

<p>위와같이 작성해줘야 한다. 즉 www 호스트네임에 대한 것도 약간 가상호스트 형식으로 올려둬야 하는 듯. (로그부분은 필요가 없어서 삭제해도 되는 것 같다)
www에 대한 것은 4번째 줄에 있는 /web/server/apache를 보도록 설정.</p>

<p>→ 이렇게 까지 하고 systemctl restart httpd.service 한 뒤에 두 주소창에 대해 새로고침하면 따로 잘 뜨게 된다. www에 대한 설정부분인 1~5줄은 7~13줄 뒷부분에 위치해도 작동 잘 된다. 즉 구분지어주기만 하면 되는 듯</p>

<p>그런데 위의 www 호스트네임에 대한 저 정보들은 /etc/httpd/conf/httpd.conf 에서 이미 Main Server 설정부분으로서 작성해주었던 값들이다. 따라서</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837434-fb6a7e00-9f03-11ea-83f4-6607aee9d2fd.png" alt="image" />
이렇게만 해줘도 된다. 이렇게만 해놓으면 www 호스트네임에 대해 /etc/httpd/conf/httpd.conf 를 보라는 설정이 된다. → 다만 여기서의 1,2 줄이 4~10 줄 뒤에 가있으면 안된다. 그렇게 하면 www호스트네임 결과값이 cafe 값을 따라감(www가 /virtual/host 를 바라보게 됨)
⇒ /etc/httpd/conf/httpd.conf 는 각 호스트 머신별 자신들이 담당하는 호스트네임페이지에 대한 설정을 두는 부분이고 혹시나 하나의 머신에서 다른 호스트부분도 담당하려면 이렇게 가상호스트를 설정해주어야 한다. 그리고 가상호스트를 설정했다면 기존의 호스트네임부분도 조금 신경을 써줘야 한다.</p>

<p>로그파일들은 /var/log/httpd 에 생겨있다.</p>

<p><img src="https://user-images.githubusercontent.com/39452092/82837439-01605f00-9f04-11ea-85f7-d2d1e87e8d12.png" alt="image" />
웹 서버를 운용하면서 생긴 로그들을 저장하는 곳. 
위의 access_log와 error_log는 www호스트네임 서버에 대한 로그파일일 것이고
그 밑의 두개는 가상호스트인 cafe 호스트 네임 서버에 대한 로그파일일 것이다.</p>

<p>다음주 데이터베이스 DB</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> 카테고리: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#linux" class="page__taxonomy-item" rel="tag">Linux</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> 업데이트:</strong> <time datetime="2020-05-26T00:00:00+09:00">May 26, 2020</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">공유하기</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Linux2_day18%20https%3A%2F%2Fictechgy.github.io%2Flinux%2FLinux2_day18%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fictechgy.github.io%2Flinux%2FLinux2_day18%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fictechgy.github.io%2Flinux%2FLinux2_day18%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="공유하기 LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/linux/Linux2_day17/" class="pagination--pager" title="Linux2_day17
">이전</a>
    
    
      <a href="/linux/Linux2_day19/" class="pagination--pager" title="Linux2_day19
">다음</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">참고</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/swift/rxswift/Swift-nil/" rel="permalink">Swift(스위프트) nil과 Type Casting(타입캐스팅)에 대한 기록 with RxSwift
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description">Swift를 다시 공부하던 도중 기록하면 좋을만한 부분이 있어서 작성한다.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/python-map/" rel="permalink">파이썬 Map 함수는 중첩해서 쓸 수 있을까? (Python Map)
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  2 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description"> 

Python Map함수는 중첩이 가능할까?
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/rxswift/error/" rel="permalink">signal과 driver 그리고 error handling에 대하여(RxSwift)
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  4 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description">이 글을 읽기 전 eungding님의 블로그와 Rhyno님의 블로그글을 참고해보자.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/rxswift/take/" rel="permalink">take Operator에 대하여(RxSwift)
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  4 분 소요

</p>
    
    <p class="archive__item-excerpt" itemprop="description">flatMap에서 take를 써야하는 경우
단도직입적으로 말하자면 아래와 같은 경우에는 반드시 써야한다.
_ = button.rx.tap.debug("TAP")
            .flatMap {
                return BehaviorRelay(value: ...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>팔로우:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/ictechgy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> 피드</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 dev blog. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>







    
  <script>
    var disqus_config = function () {
      this.page.url = "https://ictechgy.github.io/linux/Linux2_day18/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/linux/Linux2_day18"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://ictechgy-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
