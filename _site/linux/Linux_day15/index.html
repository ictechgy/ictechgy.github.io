<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.19.2 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Linux_day15 - 개발 끄적끄적</title>
<meta name="description" content="itbank 홈디렉토리만 삭제했다가 다시 만들어보기 ">


  <meta name="author" content="JJanghong">


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="개발 끄적끄적">
<meta property="og:title" content="Linux_day15">
<meta property="og:url" content="https://ictechgy.github.io/linux/Linux_day15/">


  <meta property="og:description" content="itbank 홈디렉토리만 삭제했다가 다시 만들어보기 ">



  <meta property="og:image" content="https://ictechgy.github.io/assets/images/photo-hangang.jpeg">





  <meta property="article:published_time" content="2020-05-26T00:00:00+09:00">





  

  


<link rel="canonical" href="https://ictechgy.github.io/linux/Linux_day15/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "dev blog",
      "url": "https://ictechgy.github.io/"
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="개발 끄적끄적 Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          개발 끄적끄적
          <span class="site-subtitle">개발공부</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/categories/">Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">Tags</a>
            </li><li class="masthead__menu-item">
              <a href="">About</a>
            </li><li class="masthead__menu-item">
              <a href="/about/"></a>
            </li><li class="masthead__menu-item">
              <a href="">연도별</a>
            </li><li class="masthead__menu-item">
              <a href="/posts/"></a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      



<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/photo-avatar.jpeg" alt="JJanghong" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">JJanghong</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>공부중입니다.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Republic of Korea</span>
        </li>
      

      
        
          
            <li><a href="mailto:ictechgy@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
        
          
        
          
        
          
            <li><a href="https://github.com/ictechgy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Linux_day15">
    <meta itemprop="description" content="itbank 홈디렉토리만 삭제했다가 다시 만들어보기">
    <meta itemprop="datePublished" content="2020-05-26T00:00:00+09:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Linux_day15
</h1>
          
            <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  10 minute read

</p>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p>itbank 홈디렉토리만 삭제했다가 다시 만들어보기</p>

<p>cd ~    → /root 로 이동
rm -rf /home/itbank
→ 커맨드라인이 저 안에 있는 상태로 삭제하면?
커맨드라인이 /home/itbank 안에 있는 상태에서 rm -rf /home/itbank 해봤는데 삭제는 된다. 다만 커맨드라인은 그대로 있길래 처음에 삭제 안된건줄 알고 cd .. 으로 상위로 간 다음에 ls -l 쳤는데 itbank 디렉토리 안보인다. 만약 커맨드라인이 안에 계속 있던 상태에서 touch로 파일 만드려 했다면 만들어 졌을까 안만들어졌을까?</p>

<p>mkdir /itbank</p>

<p>ls -al /itbank
→ 현재 아무것도 없는 상태</p>

<p>cp -r /etc/skel/. /itbank
→ 뼈대 옮기기
또는 처음부터 /itbank 만들지 말고 cp -r /etc/skel /itbank 라고 해놓아도 된다.</p>

<p>ls -al /itbank
해보면 skel 파일들은 있지만 소유권이 아직 root 이다.</p>

<p>우리는 현재 홈 디렉토리만 지웠지, 사용자 관련 정보는 지운 상태가 아니다. 
tail -2 /etc/passwd /etc/group</p>

<p>이제 /itbank 디렉토리와 하위 파일 및 디렉토리들 전부를 itbank 사용자 계정의 소유로 만들어야 한다. 그런데 이전에 배운 chown UID:GID 파일 또는 디렉토리명  이건 하나의 대상만을 바꿔줄 뿐 다른 부분에까지 영향을 끼치지는 못한다.</p>

<p>하위까지 소유권 바꾸기</p>

<p>chown -R UID:GID 파일 또는 디렉토리명
디렉토리명이 대상으로 올 경우 지정한 디렉토리와 그 디렉토리 하위의 소유권 전부다 변경</p>

<p>chown -R itbank:itbank /itbank  → chown -R itbank. /itbank  로 간략화 가능하다.
→ /itbank 디렉토리를 포함하여 하위의 모든 것들까지 소유권을 변경함(만약 하위의 것들만 바꾸고 싶다면 대상경로쪽에 /itbank/. 을 써주면 된다.)
ls -al /itbank를 통하여 확인. 하위에 있는 .mozilla 까지 확인해보면 다 소유권이 잘 변경되어있다.</p>

<p>이제 /itbank는 홈 디렉토리이므로 허가권까지 바꿔주어야한다.
chmod 700 /itbank</p>

<p>이렇게 홈 디렉토리를 만들고 skel을 넣고 소유권을 바꿔주는 일련의 과정들은 원래 useradd가 해주던 것.</p>

<p>이제 mv /itbank /home 으로 위치를 바꿔주도록 한다. (또는 usermod -d 로 디렉토리 위치에 대한 정보를 변경하던지)</p>

<p>cd ~itbank 로 이제 itbank 하위에서 다시 작업을 할 수 있다.</p>

<p>특수권한</p>

<p>SetUID
rwxrwxrwx 로 허가권이 있다고 할 때
—
┖&gt; user쪽과 관련이 있다.</p>

<p>특징
user쪽 허가권의 ‘x’ 자리가 ‘s’ 나 ‘S’로 표현이 됨
예를 들어, rws rwx rwx 또는 rwS rwx rwx 로 바뀜</p>

<p>s 는 x가 기존에 있었음을 나타내고,
S는 x가 없었음을 나타낸다.</p>

<p>rwS rwx rwx 는 원래 rw- rwx rwx 였던 것이다.</p>

<p>값은 8진수 모드로 4000이다.
예를 들어 rwsrwxrwx → 4777
rwSrwxrwx → 4677</p>

<p>실행파일에서 쓰이는 경우..
SetUID가 설정되어 있는 실행파일을 실행할 경우 user쪽 권한으로 실행을 함</p>

<p>윈도우에서 일반사용자인데 관리자권한으로 실행하는 것들.. SetUID
예를 들어 rwx — —  전영훈 전영훈   의 파일이 있는 경우 other에 해당하는 일반 학생은 원래 아무것도 할 수 없는데 
rws — — 라면 user쪽 권한으로 파일을 쓸 수 있다.</p>

<p>따라서 잘못주면 위험하다. other에 해당하는 사람들이 주인처럼 파일을 쓸 수 있으므로</p>

<p>SetGID</p>

<p>rwxrwxrwx
      —
      ┖&gt;  group과 관련이 있음</p>

<p>group쪽 허가권 중 ‘x’자리가 ‘s’나 ‘S’로 표현이 됨
rwxrwsrwx 또는 rwxrwSrwx</p>

<p>값은 8진수모드로 2000
rwxrwsrwx → 2777
rwxrwSrwx → 2767</p>

<p>실행파일, 디렉토리
SetUID와 동일하나 다만! group쪽 권한으로 실행을 함
→ other는 group권한을 쓴다고 하면 user또한 group권한으로 실행을 하게 되는가?</p>

<p>Sticky Bit
rwxrwxrwx
            —
            ┖&gt; other쪽과 관련이 있음</p>

<p>특징
other쪽 허가권의 ‘x’ 자리가 ‘t’나 ‘T’로 표현이 됨
예를 들어, rwxrwxrwt 또는 rwxrwxrwT
t는 x가 있음
T는 x가 없음
값은 8진수모드로 1000
rwxrwxrwt → 1777
rwxrwxrwT → 1776</p>

<p>왜 8진수 모드에서 3000은 없는걸까 왜 1000 2000 4000 이지?</p>

<p>공용디렉토리에서 사용이 된다.
Sticky Bit 가 설정되어있는 디렉토리에서는 누구든지 자유롭게 생성과 삭제를 할 수 있음
다만! 삭제시에 그 생성한 파일이나 디렉토리의 소유자나 관리자만이 삭제할 수 있음
만드는 것은 다같이 만들 수 있지만 지우는 것은 각자 자기것만 지울 수 있다.
→ 일반적으로 자유게시판. 내가 글쓰고 내가 지우고 등. 남의 것을 지울 수는 없다</p>

<p>일반권한으로는 답이 안나오니까 특수권한을 쓴다??</p>

<p>userdel -r user10
userdel: /var/spool/mail/user10은(는) user10의 소유가 아닙니다, 제거하지 않습니다
userdel: /jongno/user10은(는) user10의 소유가 아닙니다, 제거하지 않습니다
→ 아마 소유권을 바꾸지 않아서 그런 듯 user10 이 1001인데 저 파일과 디렉토리들 1003으로 둬서 그런 듯 하다. 일일히 삭제하였다.
또는 저 홈디렉토리와 메일파일 소유권을 잘 변경해주었다면 제대로 같이 다 삭제 되었을 것이다.</p>

<p>일반사용자로 접속. itbank
자신의 홈 디렉토리 하위에 mkdir a b c
→ bash쉘 옆에 $ 이 있다. 일반사용자용. #은 관리자용
vi에서 $는 커서가 줄 맨뒤로 이동하는 단축키였음. 맨 앞은 숫자 0</p>

<p>만들었다면 exit로 종료</p>

<p>관리자로 돌아와서
groupadd hello 로 그룹을 만들기</p>

<p>b와 c 디렉토리의 GID 변경
chown :hello b
chgrp hello c
→ 또는 한 줄로 합쳐서 chown :hello b c 또는 chgrp hello b c처럼 쓸 수도 있지 않을까
→ 된다. 한번에 변경 가능</p>

<p>c디렉토리만 SetGID 부여
chmod g+s c  → 억지로 chmod g+S c 했는데 작동 안된다. numeric으로 하려 한다면?
→ drwxrwsr-x. 2 itbank hello  6  5월 30 09:51 c</p>

<p>다시 itbank로 접속</p>

<p>[itbank@localhost ~]$ ls -l
합계 0
drwxrwxr-x. 2 itbank itbank 6  5월 30 09:51 a
drwxrwxr-x. 2 itbank hello  6  5월 30 09:51 b
drwxrwsr-x. 2 itbank hello  6  5월 30 09:51 c</p>

<p>[itbank@localhost ~]$ touch a/afile
[itbank@localhost ~]$ ls -l a
합계 0
-rw-rw-r–. 1 itbank itbank 0  5월 30 10:01 afile</p>

<p>[itbank@localhost ~]$ touch b/bfile
[itbank@localhost ~]$ ls -l b
합계 0
-rw-rw-r–. 1 itbank itbank 0  5월 30 10:02 bfile
→ 그냥 디렉토리의 GID가 hello일 뿐 itbank계정으로 그 하위에 파일을 만들 때에는 아무런 영향도 끼치지 못한다.</p>

<p>[itbank@localhost ~]$ touch c/cfile
[itbank@localhost ~]$ ls -l c
합계 0
-rw-rw-r–. 1 itbank hello 0  5월 30 10:03 cfile
→ 파일을 만든 사람은 itbank이지만 c디렉토리로 들어가서 파일을 만들 때 group인 hello의 허가권을 타고 들어가서 만들었다. 따라서 파일의 소유권이 itbank itbank가 아닌 itbank hello이다.</p>

<p>관리자로 돌아와서 rm -rf *
groupdel hello</p>

<p>Sticky Bit 실습</p>

<p>준비물
mkdir /everyone
권한이 755인데 777로 변경하자.
chmod go+w /everyone 또는 chmod 777 /everyone</p>

<p>useradd badman
passwd badman 로 비밀번호 생성
→ useradd -p `openssl passwd [비밀번호]` username
위의 방식은 암호화 단계가 낮다.
useradd -p [비밀번호] username 으로도 생성은 가능한 듯 보인다. 이렇게 하면 /etc/shadow에 비밀번호가 암호화되지 않은 상태로 들어가는 듯 하다. 또한 로그인도 제대로 되지 않는다고 한다.</p>

<p>itbank로 접속
cd /everyone 으로 디렉토리 이동하고 touch hifile 로 파일 생성</p>

<p>badman 접속
cd /everyone으로 디렉토리 이동. 
rm -rf hifile 으로 파일이 삭제가 된다
→ ??? 파일의 권한이 -rw-rw-r–. 1 itbank itbank 0  5월 30 10:33 hifile  이였는데???
badman은 other쪽 권한이여야하는거 아닌가? other에는 w가 없는데도 삭제가 되네.
상위 디렉토리인 /everyone에서 other쪽 권한이 rwx 다 있어서 가능한건가?
어떤 파일의 삭제에 있어서 필요한 권한은 상위 디렉토리에서의 w권한인건가. 개별적 파일의 w권한은?? 뭐 일반문서파일의 경우라면 내용수정일테고 만약 실행파일이라면?</p>

<p>아무튼 이렇게 그냥 공용디렉토리를 rwxrwxrwx 로 만들어놓으면 어떤 사용자가 만든 파일이나 디렉토리를 다른 사람이 지우거나 마음대로 수정할 수 있게 된다.
→ 그래서 이 부분을 해결하기 위해 Sticky Bit 를 쓰는 것이다.</p>

<p>관리자로 돌아와서 chmod o+t /everyone
+T 를 쓰면 안되려나  → invalid mode 라고 뜬다.</p>

<p>다시 itbank로 접속하여 everyone디렉토리 하위에 파일 생성
touch hifile2</p>

<p>badman 접속
cd /everyone으로 디렉토리를 변경하고 rm -rf hifle2를 치면
rm: cannot remove `hifile2’: 명령을 허용하지 않음 
메시지가 뜬다.</p>

<p>공용디렉토리가 필요하다면 모든 권한을 주지 말고 Sticky Bit 를 주도록 하자</p>

<p>관리자로 돌아와서 
rm -rf /everyone
userdel -r badman</p>

<p>SetUID 실습
일단 passwd라는 것을 찾자
find / -name passwd</p>

<p>나온 결과값이 여러개이다. 그런데 뭐가 디렉토리이고 뭐가 파일인지 모른다.
find / -name passwd -type d  → 디렉토리만 나옴
find / -name passwd -type f  → 파일만 나옴</p>

<p>find /sys /etc /usr /backup -name passwd -type f -exec ls -l {} \;</p>

<p>-rwsr-xr-x. 1 root root 27832  6월 10  2014 /usr/bin/passwd</p>

<p>위 파일만이 실습에 적절
user쪽 권한에 s가 있고 유일하게 실행가능한 파일이다.</p>

<p>→ 위의 passwd파일은 사용자의 로그인 비밀번호를 변경하는 실행파일이다. passwd를 사용시 입력한 비밀번호값은 암호화되어 /etc/shadow로 들어가는 것 같다.</p>

<p>SetUID 실습</p>

<p>준비물
/usr/bin/passwd</p>

<p>/usr/bin/passwd 실행파일을 이용하여 itbank 사용자 계정의 비밀번호 변경 테스트
→ passwd는 비밀번호 변경 실행파일이다. 관리자만이 다른 계정의 비밀번호도 변경 할 수 있고 일반 사용자는 자신의 비밀번호만을 변경 할 수 있다.</p>

<p>아래와같이 /usr/bin/passwd 실행파일의 허가권을 변경하면서 작업</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>		명령 실행			비밀번호 변경
</code></pre></div></div>

<p>4755		         명령실행 잘 됨		        비밀번호 변경 잘 됨
-rwsr-xr-x. 1 root root 27832  6월 10  2014 /usr/bin/passwd</p>

<p>755			명령 실행 됨		     비밀번호 변경 불가(인증 토큰 수정 오류)
chmod u-s /usr/bin/passwd
-rwxr-xr-x. 1 root root 27832  6월 10  2014 /usr/bin/passwd</p>

<p>4750			명령어부터 작동불가(허가거부)
chmod u+s,o-rx /usr/bin/passwd
-rwsr-x—. 1 root root 27832  6월 10  2014 /usr/bin/passwd</p>

<p>암호변경 까다롭다. 사전에 있는 것을 기반으로 못하게 만들고.
회전적용도 못하게 만듬</p>

<p>passwd 실행파일의 소유권은 root root 이다.
itbank는 해당 파일을 실행시 other쪽 허가권을 보아야 한다.
실행의 여부는 other의 x에 달려있다. (실행조차도 user쪽도 봐야 할 줄 알았는데)</p>

<p>비밀번호 변경은 user쪽의 s에 달려있다.</p>

<p>비밀번호 변경은 오직 root만 할 수 있는데 일반 사용자도 관리자 권한을 빌려서 비밀번호 변경을 할 수 있다</p>

<p>비밀번호를 변경한건 결국 w허가권을 통해 파일을 건드린 것인가
아니면 passwd 명령어를 통해서 /etc/shadow를 건드린 것인가..
shadow 쪽 내용 안에는 비밀번호가 암호화되어있어서 직접적으로 내용을 변경할 수 있을지는 모르겠고. 변경해도 먹힐지도 모르겠음.</p>

<p>파일을 실행해서 s를 통해 관리자권한으로 접근을 했을 때 비밀번호를 변경 가능 한 것은 결국 w덕분인것 아닌가? 만약 위의 경우 중 두번째 허가권을 -rwxr-xrwx 로 other쪽에 w권한을 준다면 비밀번호 변경 가능하지 않을까? 
→ 안된다. -rwxrwxrwx 로 권한을 다 줬는데 itbank로 들어가서 passwd실행시 비밀번호 변경이 안된다..역시나 x권한은 있으니 명령어 실행까지는 잘 된다… w권한으로 인해 비밀번호를 변경하는게 아니라 진짜 s덕분인 것 뿐인가??</p>

<p>만약 passwd를 못쓰게 할거라면 두번째보다는 세번째로 만들어두자..
두번째로 허가권 두게 되면 명령어가 되는건지 안되는건지 헷갈리게 된다.</p>

<p>symbolic으로만 허가권을 바꿀 수 있는 파일은 따로 있다.</p>

<p>관리자계정으로 돌아와서.. 다시 원래대로 바꾸기
passwd itbank  → itbank 사용자 비밀번호 itbank로 바꾸기
chmod 4755 /usr/bin/passwd
→ -rwsr-xr-x 로 되돌리는건데 other에 솔직히 r은 없어도 되는거 아닌가..?
passwd 파일 vi로 봤는데.. 이상한 값들만 많다. r만 있으면 cat로 볼 수는 있는데 vi실행조차도 불가능할라나? 아니면 실행은 되는데 저장이 안되는걸까? → itbank 계정으로 passwd 실행파일 vi 로 보는 것은 일단 된다. 저장은.. 잘못될까봐 뭐 안해보긴 했는데.. 안되지 않을까 w권한이 없으니까..</p>

<p>umask</p>

<p>디렉토리의 최대 허가권 값은 rwxrwxrwx 777이다.</p>

<p>파일의 최대 허가권 값은 rw-rw-rw- (문서파일) 666이다.</p>

<p>관리자가 디렉토리를 생성하면 기본 허가권이 rwxr-xr-x 755
rwxrwxrwx - rwxr-xr-x = —-w–w- 22</p>

<p>일반사용자가 디렉토리를 생성하면 기본 허가권이 rwxrwxr-x 775
rwxrwxrwx - rwxrwxr-x = ——-w- 2</p>

<p>관리자가 파일을 생성하면 기본 허가권이 rw-r–r– 644
rw-rw-rw-  -  rw-r–r– = —-w–w- 22</p>

<p>일반 사용자가 파일을 생성하면 기본 허가권이 rw-rw-r– 664
rw-rw-rw-  -  rw-rw-r– = ——-w- 2</p>

<p>이렇게 되는 것을 umask라고 한다.
파일이나 디렉토리 생성시 기본 허가권(permission)을 지정하는 지시자 역할을 한다.
최대허가권에서 umask를 빼서 실질적 허가권이 만들어지고 있었다.
umask가 디렉토리와 파일별로 따로 있는게 아니라 같이 있다. 22또는 2(대표적인 값)
관리자와 사용자에 대한 umask값만 다르다.</p>

<p>왜 이렇게 되는것인가?
왜 수많은 값중에서 umask에서 22와 2를 지정해놓았는가
→ 쓰기가 굉장히 중요하므로. w허가권의 중요성
그래서 w만 쏙쏙 빼놓음</p>

<p>관리자는 자신 user만 모든 걸 할 수 있게 그룹에도 w는 안줌. 오직 본인만 다 할 수 있다.
사용자는 그룹까지도 w를 줬는데 other만큼은 w안줌</p>

<p>r - x : 박물관같은 것. 
x를 통해 접근할 수 있다.(박물관 입장) r을 통해 볼 수 있다.(관람) 
다만 w 수정 삭제 등 write쓸 수는 없다.(물품을 만지거나 사진을 찍거나 하지 마시오)</p>

<p>umask로 짝수를 두는 이유..
문서파일에서 x는 없으므로 문서파일 허가권은 항상 짝수값만 나온다.
즉 umask로 홀수값을 둔 상황일 때 디렉토리면 상관이 없는데 파일을 만드는 경우 x는 무시가 된다.
디렉토리라면 umask가 홀수면 x부분을 없애며 만들테지만 파일에서는 기본적으로 x가 없으니 홀수인 부분을 제거할 그런게 없다.</p>

<p>umask에서 x는 무시한다. 
rw- rw- rw-  -  –x-w–wx = rw-r–r– 644</p>

<p>umask가 없었다면 파일이나 디렉토리를 만들 때 허가권이 항상 다 최대값이 나왔을 것. 일일히 변경했어야 했을 것이다.
umask가 있음으로서 기본적인 허가권체계를 갖출 수 있다.</p>

<p>사용형식
umask
→ umask의 설정 값을 출력</p>

<p>umask [option] 값
→ umask의 설정값을 변경</p>

<p>관리자로 로그인한 상태에서 umask치면 0022나오고 일반사용자는 0002나온다</p>

<p>umask [option]      → man umask 치면 그냥 리눅스 명령어들 나오는 메뉴얼이 보이고.. umask –help는 없는 옵션명령어이다.. 대신 어떤 옵션이 있는지 나오기는 하는데 어떤 역할인지는 안보임.
man명령어나 파일의 내용을 읽는 명령어에서 vi말고 내용 안에서 뭐 찾는거 그런거 하는 방법 없나.. 콜론 입력만 되고 그 이후에 뭐 누르면 아무것도 안됨</p>

<p>option
-S : 문자로 umask의 설정 값을 출력
String</p>

<p>umask -S  → 0022로 되어있다.(root)
u=rwx,g=rx,o=rx
위와 같이 나온게 umask 자체가 아니다. 위에 보면 w가 없는데 w없도록 만들어 준 것이 umask이다. 즉 umask는 —-w–w-로 되어있다는 것을 알 수 있다.</p>

<p>umask 한번 변경해도 다시 접속하면 초기화가 된다.
alias도 그랬는데..</p>

<p>ls -l /etc/profile → 리눅스 전체 환경변수 파일
vi로 들어가서 직접 건드려야 umask 계속 유지된다.
60번째 줄을 보면 if else문이 있다.
일반사용자들은 umask가 002이고 else 즉, 관리자는 022</p>

<p>여기서 조정하면 모든 사용자에 대한 umask가 변경이 될 것 같은데 개별사용자의 umask 영구조정은 없는건가? alias는 개별사용자별 변경이 되는데</p>

<p>umask치면 0002 또는 0022 나오던데 네번째 자리 숫자까지 조정할 수 있는건가? 
그 SetUID SetGID Sticky Bit와 관련해서?</p>

<p>alias 는 /etc/bashrc 에 있었지 않았나. 보통 사용자별로 alias가 따로 있는 경우에는 각각의 홈 디렉토리 하위에 bashrc가 있었고..</p>

<p>그런데.. 이렇게 umask가 002 또는 022인데..
왜 홈디렉토리는 700인가? umask가 077인건가?
→ 사용자 생성(홈디렉토리)과 관련된 umask가 따로 있다.</p>

<p>/etc/login.defs에 있다.
vi로 보면 각종 설정값들이 있다.
메일파일이 생기는 곳 위치와..
비밀번호관련 설정값</p>

<p>유저나 그룹 생성시
UID와 GID 최소값 최대값
7에서는 UID 최소값이 1000인데 6이하에서는 500이었었다.</p>

<p>시스템 계정에 대한 UID GID최소값  최대값</p>

<p>홈 디렉토리 생성여부</p>

<p>UMASK 값이 있다. 077
홈디렉토리 생성시에는 위 umask값을 이용한다.</p>

<p>:q! 로 나가자. 혹시 모르니까</p>

<p>사용자 생성과 그룹생성관련 /etc/login.defs  → 사용자 홈디렉토리 관련 UMASK
전체적 환경변수쪽 /etc/profile  → 파일 및 디렉토리와 관련된 UMASK</p>

<p>사용자 생성시 홈디렉토리에 대해서는 login.defs의 umask를 본다.</p>

<p>리눅스 압축 배울 것이다.</p>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#linux" class="page__taxonomy-item" rel="tag">Linux</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-05-26T00:00:00+09:00">May 26, 2020</time></p>
        
      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Linux_day15%20https%3A%2F%2Fictechgy.github.io%2Flinux%2FLinux_day15%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fictechgy.github.io%2Flinux%2FLinux_day15%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fictechgy.github.io%2Flinux%2FLinux_day15%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/linux/Linux_day14/" class="pagination--pager" title="Linux_day14
">Previous</a>
    
    
      <a href="/linux/Linux_day16/" class="pagination--pager" title="Linux_day16
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You may also enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/linux/Linux_day9/" rel="permalink">Linux_day9
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  11 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">디렉토리 삭제 rmdir은 내부가 비어있는 경우에만 디렉토리 제거 가능 → 안에 파일이 있어도 삭제 할 수 있는 옵션은?
→ 없다. man rmdir 및 rmdir –help 로 내부 옵션 살폈는데 안에 파일이 있어도 삭제할 수 있는 옵션은 존재하지 않는다.
결국 rm -r 을 사...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/linux/Linux_day8/" rel="permalink">Linux_day8
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  9 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">putty접속 안됐으나 VMware 가상네트워크설정에서 NAT에 있어서 두가지 체크사항 건드리니까 다시 됨. 한가지만 체크되어있었는데 먼저 체크 푼 다음에 설정창 껐다가 다시 키고, 체크사항 두개 다시 체크한 뒤에 설정창 끔.  OS GUI에서도 네트워크 설정부분 껐다가 켰다. 아...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/linux/Linux_day7/" rel="permalink">Linux_day7
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  5 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">vi(Visual Editor) → vi-sual editor. 줄여서 VI Editor 라고도 한다.
한 줄씩 편집하는 줄 단위 편집기가 아니라 한 화면을 편집하는 비주얼 에디터라는 뜻에서 유래 → 그러면 줄 단위 편집기도 있었다는건가???
간결하면서도 강력한 기능을 제공
GUI...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/photo-hangang.jpeg" alt="">
      </div>
    
    <h2 class="archive__item-title" itemprop="headline">
      
        <a href="/linux/Linux_day6/" rel="permalink">Linux_day6
</a>
      
    </h2>
    
      <p class="page__meta"><i class="far fa-clock" aria-hidden="true"></i> 




  8 minute read

</p>
    
    <p class="archive__item-excerpt" itemprop="description">논리연산자
이전시간에 우리는 논리연산자 &amp;&amp;와 ||를 배웠다.
a &amp;&amp; b → a가 실행되면 b도 실행. a가 실행되지 않으면 b도 미실행
a || b → a가 실행되면 b는 미실행, a가 미실행되면 b는 실행
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
          <li><a href="https://github.com/ictechgy" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
      
        
      
        
      
    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2021 dev blog. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script src="https://kit.fontawesome.com/4eee35f757.js"></script>







    
  <script>
    var disqus_config = function () {
      this.page.url = "https://ictechgy.github.io/linux/Linux_day15/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/linux/Linux_day15"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://ictechgy-github-io.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
